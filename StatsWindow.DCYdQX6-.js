import{_ as a,e as s}from"./index.BXZ9s8x4.js";import{F as t}from"./FloatingWindow.CPrAeHZa.js";import{r as l,c as e,w as n,a as i,o as c,q as o,e as d,s as u,f as v,b as r,v as p,h,n as g,t as m,u as b,F as y,g as f,l as C}from"./vendor.C2p1521c.js";const k={class:"stats-content"},w={class:"stats-section goal-section"},S={class:"goal-progress"},M={class:"goal-bar"},x={class:"goal-text"},$={key:0,class:"goal-badge"},_={class:"stats-section challenge-section"},z=["disabled"],F={class:"challenge-info"},j={key:0,class:"current-score"},q={class:"stats-section"},D={class:"stats-row"},I={class:"stat-item"},T={class:"stat-value"},B={class:"stat-item"},G={class:"stat-value"},H={class:"stat-item highlight"},Q={class:"stat-value"},W={class:"stats-section"},L={class:"stats-row"},A={class:"stat-item"},E={class:"stat-value"},J={class:"stat-item"},K={class:"stat-value"},N={class:"stat-item"},O={class:"stat-value"},P={class:"stats-section"},R={class:"stats-row streak-row"},U={class:"stat-value"},V={key:0},X={class:"stat-item"},Y={class:"stat-value"},Z={class:"stats-section"},aa={class:"stats-row"},sa={class:"stat-item wide"},ta={class:"stat-value"},la={key:0,class:"stats-section"},ea={class:"trend-chart"},na=["title"],ia={key:0,class:"trend-value"},ca={class:"trend-label"},oa=a({__name:"StatsWindow",props:{visible:{type:Boolean,default:!0}},emits:["close"],setup(a){const{quizStats:oa,loadQuizStats:da,resetQuizStats:ua,statsHistory:va,loadStatsHistory:ra,challengeMode:pa,challengeStartTime:ha,challengeTimeLimit:ga,challengeScore:ma,challengeBestScore:ba,startChallenge:ya,endChallenge:fa,loadChallengeStats:Ca}=s(),ka=l(600);let wa=null;const Sa=e(()=>`${Math.floor(ka.value/60)}:${(ka.value%60).toString().padStart(2,"0")}`);function Ma(){wa&&(clearInterval(wa),wa=null)}n(pa,a=>{a?(ka.value=ga.value,wa=setInterval(()=>{if(ha.value){const a=Math.floor((Date.now()-ha.value)/1e3);ka.value=Math.max(0,ga.value-a),ka.value<=0&&(Ma(),fa())}},100)):Ma()}),i(()=>{Ma()});const xa=e(()=>{const a=oa.value.dailyGoal||60;return Math.min(100,Math.round(oa.value.todayCount/a*100))});function $a(){ya()}const _a=e(()=>0===oa.value.todayCount?0:Math.round(oa.value.todayCorrect/oa.value.todayCount*100)),za=e(()=>0===oa.value.totalCount?0:Math.round(oa.value.correctCount/oa.value.totalCount*100)),Fa=e(()=>0===oa.value.totalCount?"0.0":(oa.value.totalTime/oa.value.totalCount).toFixed(1)),ja=e(()=>(va.value||[]).slice(-7)),qa=e(()=>0===ja.value.length?1:Math.max(...ja.value.map(a=>a.count),1));return c(()=>{da(),Ca(),ra()}),(s,l)=>(d(),o(t,{visible:a.visible,title:"å­¦ä¹ ç»Ÿè®¡",icon:"ğŸ“Š",theme:"green","storage-key":"quizStats","default-width":240,"default-height":260,"default-x":20,"default-y":450,"min-width":200,"min-height":180,onClose:l[1]||(l[1]=a=>s.$emit("close"))},{"header-extra":u(()=>[v("button",{onClick:l[0]||(l[0]=(...a)=>b(ua)&&b(ua)(...a)),class:"reset-btn",title:"é‡ç½®ç»Ÿè®¡"},"ğŸ”„")]),default:u(()=>[v("div",k,[v("div",w,[l[2]||(l[2]=v("div",{class:"section-title"},"ğŸ¯ ä»Šæ—¥ç›®æ ‡",-1)),v("div",S,[v("div",M,[v("div",{class:g(["goal-fill",{completed:xa.value>=100}]),style:h({width:xa.value+"%"})},null,6)]),v("div",x,[v("span",{class:g({completed:xa.value>=100})},m(b(oa).todayCount)+" / "+m(b(oa).dailyGoal||60),3),xa.value>=100?(d(),r("span",$,"ğŸ‰ è¾¾æˆ!")):p("",!0)])])]),v("div",_,[v("button",{onClick:$a,class:"challenge-btn",disabled:b(pa)},[b(pa)?(d(),r(y,{key:0},[f(" â±ï¸ "+m(Sa.value),1)],64)):(d(),r(y,{key:1},[f(" â±ï¸ 10åˆ†é’ŸæŒ‘æˆ˜ ")],64))],8,z),v("div",F,[v("span",null,"æœ€é«˜åˆ†: ğŸ† "+m(b(ba)),1),b(pa)?(d(),r("span",j,"å¾—åˆ†: "+m(b(ma)),1)):p("",!0)])]),v("div",q,[l[6]||(l[6]=v("div",{class:"section-title"},"ğŸ“… ä»Šæ—¥",-1)),v("div",D,[v("div",I,[v("span",T,m(b(oa).todayCorrect),1),l[3]||(l[3]=v("span",{class:"stat-label"},"æ­£ç¡®",-1))]),v("div",B,[v("span",G,m(b(oa).todayCount),1),l[4]||(l[4]=v("span",{class:"stat-label"},"æ€»æ•°",-1))]),v("div",H,[v("span",Q,m(_a.value)+"%",1),l[5]||(l[5]=v("span",{class:"stat-label"},"æ­£ç¡®ç‡",-1))])])]),v("div",W,[l[10]||(l[10]=v("div",{class:"section-title"},"ğŸ“ˆ ç´¯è®¡",-1)),v("div",L,[v("div",A,[v("span",E,m(b(oa).correctCount),1),l[7]||(l[7]=v("span",{class:"stat-label"},"æ­£ç¡®",-1))]),v("div",J,[v("span",K,m(b(oa).totalCount),1),l[8]||(l[8]=v("span",{class:"stat-label"},"æ€»æ•°",-1))]),v("div",N,[v("span",O,m(za.value)+"%",1),l[9]||(l[9]=v("span",{class:"stat-label"},"æ­£ç¡®ç‡",-1))])])]),v("div",P,[l[13]||(l[13]=v("div",{class:"section-title"},"ğŸ”¥ è¿ç»­",-1)),v("div",R,[v("div",{class:g(["stat-item streak",{"on-fire":b(oa).streak>=5}])},[v("span",U,[b(oa).streak>=5?(d(),r("span",V,"ğŸ”¥")):p("",!0),f(" "+m(b(oa).streak),1)]),l[11]||(l[11]=v("span",{class:"stat-label"},"å½“å‰è¿ç»­",-1))],2),v("div",X,[v("span",Y,"ğŸ† "+m(b(oa).bestStreak),1),l[12]||(l[12]=v("span",{class:"stat-label"},"æœ€ä½³è®°å½•",-1))])])]),v("div",Z,[l[15]||(l[15]=v("div",{class:"section-title"},"â±ï¸ æ•ˆç‡",-1)),v("div",aa,[v("div",sa,[v("span",ta,m(Fa.value)+"s",1),l[14]||(l[14]=v("span",{class:"stat-label"},"å¹³å‡ç­”é¢˜ç”¨æ—¶",-1))])])]),ja.value.length>0?(d(),r("div",la,[l[16]||(l[16]=v("div",{class:"section-title"},"ğŸ“ˆ è¿‘7å¤©è¶‹åŠ¿",-1)),v("div",ea,[(d(!0),r(y,null,C(ja.value,a=>{return d(),r("div",{key:a.date,class:"trend-bar-wrapper",title:`${a.date}: ${a.correct}/${a.count}`},[v("div",{class:"trend-bar",style:h({height:(t=a.count,Math.round(t/qa.value*100)+"%")})},[a.count>0?(d(),r("span",ia,m(a.count),1)):p("",!0)],4),v("span",ca,m((s=a.date,["æ—¥","ä¸€","äºŒ","ä¸‰","å››","äº”","å…­"][new Date(s).getDay()])),1)],8,na);var s,t}),128))]),l[17]||(l[17]=v("div",{class:"trend-legend"},[v("span",null,"ç­”é¢˜æ•°é‡è¶‹åŠ¿")],-1))])):p("",!0)])]),_:1},8,["visible"]))}},[["__scopeId","data-v-402d3aff"]]);export{oa as default};
