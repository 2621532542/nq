var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,r=(t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a,i=(e,t)=>{for(var s in t||(t={}))n.call(t,s)&&r(e,s,t[s]);if(a)for(var s of a(t))l.call(t,s)&&r(e,s,t[s]);return e},o=(e,a)=>t(e,s(a)),u=(e,t,s)=>new Promise((a,n)=>{var l=e=>{try{i(s.next(e))}catch(t){n(t)}},r=e=>{try{i(s.throw(e))}catch(t){n(t)}},i=e=>e.done?a(e.value):Promise.resolve(e.value).then(l,r);i((s=s.apply(e,t)).next())});import{e as c,r as d,m as h,i as p,h as y,a as v,b as m,c as f,t as g,g as b,o as C,w,n as k,d as T,f as _,j as x,k as A,l as P,p as H,q as R,s as S,u as $,v as j,x as O,y as z,F as M,z as E,A as I,B as L,C as N,D as G,E as D,G as Z,H as q,I as F,J as B,K as U,T as W,L as V}from"./vendor.DsTb5llR.js";
/*!
 * pinia v3.0.3
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */
let J;!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const K=e=>J=e,X=Symbol();function Y(e){return e&&"object"==typeof e&&"[object Object]"===Object.prototype.toString.call(e)&&"function"!=typeof e.toJSON}var Q,ee;(ee=Q||(Q={})).direct="direct",ee.patchObject="patch object",ee.patchFunction="patch function";const te=()=>{};function se(e,t,s,a=te){e.push(t);const n=()=>{const s=e.indexOf(t);s>-1&&(e.splice(s,1),a())};return!s&&b()&&C(n),n}function ae(e,...t){e.slice().forEach(e=>{e(...t)})}const ne=e=>e(),le=Symbol(),re=Symbol();function ie(e,t){e instanceof Map&&t instanceof Map?t.forEach((t,s)=>e.set(s,t)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const s in t){if(!t.hasOwnProperty(s))continue;const a=t[s],n=e[s];Y(n)&&Y(a)&&e.hasOwnProperty(s)&&!m(a)&&!f(a)?e[s]=ie(n,a):e[s]=a}return e}const oe=Symbol();function ue(e){return!Y(e)||!Object.prototype.hasOwnProperty.call(e,oe)}const{assign:ce}=Object;function de(e){return!(!m(e)||!e.effect)}function he(e,t,s={},a,n,l){let r;const i=ce({actions:{}},s),o={deep:!0};let u,h,p,y=[],b=[];const C=a.state.value[e];let T;function _(t){let s;u=h=!1,"function"==typeof t?(t(a.state.value[e]),s={type:Q.patchFunction,storeId:e,events:p}):(ie(a.state.value[e],t),s={type:Q.patchObject,payload:t,storeId:e,events:p});const n=T=Symbol();k().then(()=>{T===n&&(u=!0)}),h=!0,ae(y,s,a.state.value[e])}l||C||(a.state.value[e]={}),d({});const x=l?function(){const{state:e}=s,t=e?e():{};this.$patch(e=>{ce(e,t)})}:te;const A=(t,s="")=>{if(le in t)return t[re]=s,t;const n=function(){K(a);const s=Array.from(arguments),l=[],r=[];let i;ae(b,{args:s,name:n[re],store:H,after:function(e){l.push(e)},onError:function(e){r.push(e)}});try{i=t.apply(this&&this.$id===e?this:H,s)}catch(o){throw ae(r,o),o}return i instanceof Promise?i.then(e=>(ae(l,e),e)).catch(e=>(ae(r,e),Promise.reject(e))):(ae(l,i),i)};return n[le]=!0,n[re]=s,n},P={_p:a,$id:e,$onAction:se.bind(null,b),$patch:_,$reset:x,$subscribe(t,s={}){const n=se(y,t,s.detached,()=>l()),l=r.run(()=>w(()=>a.state.value[e],a=>{("sync"===s.flush?h:u)&&t({storeId:e,type:Q.direct,events:p},a)},ce({},o,s)));return n},$dispose:function(){r.stop(),y=[],b=[],a._s.delete(e)}},H=v(P);a._s.set(e,H);const R=(a._a&&a._a.runWithContext||ne)(()=>a._e.run(()=>(r=c()).run(()=>t({action:A}))));for(const c in R){const t=R[c];if(m(t)&&!de(t)||f(t))l||(C&&ue(t)&&(m(t)?t.value=C[c]:ie(t,C[c])),a.state.value[e][c]=t);else if("function"==typeof t){const e=A(t,c);R[c]=e,i.actions[c]=t}}return ce(H,R),ce(g(H),R),Object.defineProperty(H,"$state",{get:()=>a.state.value[e],set:e=>{_(t=>{ce(t,e)})}}),a._p.forEach(e=>{ce(H,r.run(()=>e({store:H,app:a._a,pinia:a,options:i})))}),C&&l&&s.hydrate&&s.hydrate(H.$state,C),u=!0,h=!0,H}
/*! #__NO_SIDE_EFFECTS__ */function pe(e,t,s){let a;const n="function"==typeof t;function l(s,l){const r=y();(s=s||(r?p(X,null):null))&&K(s),(s=J)._s.has(e)||(n?he(e,t,a,s):function(e,t,s){const{state:a,actions:n,getters:l}=t,r=s.state.value[e];let i;i=he(e,function(){r||(s.state.value[e]=a?a():{});const t=T(s.state.value[e]);return ce(t,n,Object.keys(l||{}).reduce((t,a)=>(t[a]=h(_(()=>{K(s);const t=s._s.get(e);return l[a].call(t,t)})),t),{}))},t,s,0,!0)}(e,a,s));return s._s.get(e)}return a=n?s:t,l.$id=e,l}const ye=new class{constructor(e=1e3){this.cache=new Map,this.maxSize=e}getCacheKey(e,t){return`${e.sort().join(",")}-${t}`}get(e,t){const s=this.getCacheKey(e,t);return this.cache.get(s)}set(e,t,s){const a=this.getCacheKey(e,t);if(this.cache.size>=this.maxSize){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(a,o(i({},s),{cached:!0,timestamp:Date.now()}))}clear(){this.cache.clear()}};class ve extends Error{constructor(e,t,s={}){super(t),this.name="MahjongAnalysisError",this.code=e,this.details=s}}const me="INVALID_HAND",fe="INVALID_GAME_TYPE",ge="ALGORITHM_ERROR",be="TIMEOUT";class Ce{constructor(e){this.type=e,this.useCards=[],this.laiZiCards=[]}}class we{constructor(e,t){this.key=e,this.value=t}}class ke{constructor(){this.canPlayCards=[],this.needCards=[],this.tingCount=0,this.round=0,this.type=0,this.bestPlayCard=0,this.needCardGroups=[],this.gang=[]}}class Te{constructor(){this.playCardGroups=[],this.userCardCount=0,this.laiZiCardCount=0,this.laiZiCount=0,this.may=new Map,this.must=[],this.all=new Map}}function _e(e,t){if(0===t)return[[]];if(0===e.length)return[];const[s,...a]=e,n=_e(a,t),l=_e(a,t-1).map(e=>[s,...e]);return n.concat(l)}function xe(e){if(e.length<2){if(1===e.length){const t=e[0],s=[];return s.push(t),t%10>1&&s.push(t-1),t%10<9&&s.push(t+1),s}return[]}const[t,s]=e,a=s-t,n=[];return 1===a?(t%10>1&&n.push(t-1),s%10<9&&n.push(s+1)):2===a&&n.push(t+1),n}function Ae(e,t,s){for(const a of e)if(a.useCards.includes(t)){const n=[...e],l=n.indexOf(a);n.splice(l,1);const r=[...a.useCards];r.splice(r.indexOf(t),1);const i=xe(r),o=i.indexOf(t);o>-1&&i.splice(o,1);for(const e of i)s.add(e),Ae(n,e,s)}}function Pe(e,t,s){if(t>=38)return[];if(0===e[t])return Pe(e,t+1,s);if(!(t<30&&t%10!=9&&(e[t+1]>0||e[t+2]>0)))return $e(e,t,s);const a=function(e,t,s){e=[...e];const a=new Ce(1);for(let l=0;l<3;l++){const s=t+l;e[s]>0?(e[s]--,a.useCards.push(s)):2===l&&t%10==8?a.laiZiCards.push(t-1):a.laiZiCards.push(s)}const n=[];if(0===a.laiZiCards.length&&t%10>1){const a=new Ce(1),l=[...e];l[t+2]++,a.useCards=[t,t+1],a.laiZiCards.push(t-1),Se(a,Pe(l,t,s),n)}return Se(a,Pe(e,t,s),n),n}(e,t,s),n=$e(e,t,s);return a.concat(n)}function He(e,t,s){if(t>=38)return[];if(0===e[t])return He(e,t+1,s);if(!(t<30&&t%10!=9&&(e[t+1]>0||e[t+2]>0)))return je(e,t,s);const a=function(e,t,s){e=[...e];const a=new Ce(1);for(let l=0;l<3;l++){const s=t+l;e[s]>0?(e[s]--,a.useCards.push(s)):2===l&&t%10==8?a.laiZiCards.push(t-1):a.laiZiCards.push(s)}const n=[];if(0===a.laiZiCards.length&&t%10>1){const a=new Ce(1),l=[...e];l[t+2]++,a.useCards=[t,t+1],a.laiZiCards.push(t-1),Se(a,He(l,t,s),n)}return Se(a,He(e,t,s),n),n}(e,t,s),n=je(e,t,s);return a.concat(n)}function Re(e,t){if(0===t.length){const t=[[]];return t[0].push(e),t}for(const s of t)s.push(e);return t}function Se(e,t,s){if(0===t.length)s.push([e]);else for(const a of t)a.push(e),s.push(a)}function $e(e,t,s){const a=(e=[...e])[t];e[t]=0;const n=[];if(4===a){e[t]=1;const a=new Ce(3);return a.useCards.push(t,t,t),Re(a,Pe(e,t,s))}if(3===a){const a=new Ce(3);if(a.useCards.push(t,t,t),Se(a,Pe(e,t+1,s),n),!s){const s=new Ce(2);s.useCards.push(t,t),e[t]=1,Se(s,Pe(e,t,!0),n)}}else if(2===a){const a=new Ce(3);if(a.useCards.push(t,t),a.laiZiCards.push(t),Se(a,Pe(e,t+1,s),n),!s){const s=new Ce(2);s.useCards.push(t,t),Se(s,Pe(e,t+1,!0),n)}}else if(1===a){const a=new Ce(3);if(a.useCards.push(t),a.laiZiCards.push(t,t),Se(a,Pe(e,t+1,s),n),!s){const s=new Ce(2);s.useCards.push(t),s.laiZiCards.push(t),Se(s,Pe(e,t+1,!0),n)}}return n}function je(e,t,s){const a=(e=[...e])[t];e[t]=0;const n=[];if(4===a){e[t]=1;const a=new Ce(3);return a.useCards.push(t,t,t),Re(a,He(e,t,s))}if(3===a){const a=new Ce(3);if(a.useCards.push(t,t,t),Se(a,He(e,t+1,s),n),!s&&[2,5,8].includes(t%10)){const s=new Ce(2);s.useCards.push(t,t),e[t]=1,Se(s,He(e,t,!0),n)}}else if(2===a){const a=new Ce(3);if(a.useCards.push(t,t),a.laiZiCards.push(t),Se(a,He(e,t+1,s),n),!s&&[2,5,8].includes(t%10)){const s=new Ce(2);s.useCards.push(t,t),Se(s,He(e,t+1,!0),n)}}else if(1===a){const a=new Ce(3);if(a.useCards.push(t),a.laiZiCards.push(t,t),Se(a,He(e,t+1,s),n),!s&&[2,5,8].includes(t%10)){const s=new Ce(2);s.useCards.push(t),s.laiZiCards.push(t),Se(s,He(e,t+1,!0),n)}}return n}function Oe(e,t){switch(t){case 0:case 3:default:return 41===e;case 2:return 35===e}}function ze(e,t,s){let a=0;[1,4,7,10,13].includes(e.length)&&(a=1);const n=Math.floor(e.length/3)+1,l=Array(39).fill(0);let r=0;for(const v of e)Oe(v,s)?r++:l[v]++;if(r===e.length){const e=new ke;return e.type=8,e}const i=function(e,t){const s=Array(39).fill(0);for(const a of e)Oe(a,t)||s[a]++;return 3===t?He(s,1,!1):Pe(s,1,!1)}(e,s);i.sort((e,t)=>e.length-t.length);let o=14;const u=[];for(const v of i){let e=0;const t=v.length-n,s=new Map;let a=!1;const l=[],i=new Map,c=new Map;let d=0;for(const n of v)d++,e+=n.laiZiCards.length,n.id=d,n.laiZiCards.length>0&&i.set(n.id,n),2!==n.type?(c.set(n.id,n),n.laiZiCards.length>0?s.set(n.id,n):0===n.laiZiCards.length&&1===n.type&&l.push(...n.useCards)):a=!0;if(e===r){const e=new ke;return e.round=0,e}if(a)if(t===i.size||0===s.size&&t===i.size||0===t){const t=new Te;t.playCardGroups=[],t.userCardCount=0,t.laiZiCardCount=0,t.laiZiCount=e,t.may=new Map(i),t.must=l,t.all=c,u.push(t),o=Math.min(o,e)}else if(t>0){const a=_e(Array.from(s.values()),t);for(const t of a){let s=0,a=0;const n=new Map(i),r=new Map(c);for(const e of t)s+=e.useCards.length,a+=e.laiZiCards.length,n.delete(e.id),r.delete(e.id);o=Math.min(o,s);const d=new Te;d.playCardGroups=t,d.userCardCount=s,d.laiZiCardCount=a,d.laiZiCount=e,d.may=n,d.must=l,d.all=r,u.push(d)}}}const c=new Map,d=new Set;let h=0;const p=[];for(const v of u){const e=o;if(a>0&&1===o&&0===v.playCardGroups.length&&(o=0),v.userCardCount<=e&&v.laiZiCount-v.laiZiCardCount===v.userCardCount+a+r){for(const t of v.playCardGroups)for(const e of t.useCards)c.set(e,(c.get(e)||0)+1);const e=new Set;for(const t of v.may.values())if(e.add(...t.laiZiCards),t.useCards[0]<30){const s=Math.floor(t.useCards[0]/10),a=[];for(const e of v.all.values())e.id!==t.id&&Math.floor(e.useCards[0]/10)===s&&3!==e.type&&a.push(e);if(1===t.type){if(1===t.laiZiCards.length){const s=xe(t.useCards);for(const t of s)e.add(t),Ae(a,t,e)}}else if(2===t.type)1===t.laiZiCards.length&&Ae(a,t.useCards[0],e);else if(3===t.type&&2===t.laiZiCards.length){const s=t.useCards[0],n=[],l=s%10;l-2>0&&n.push(s-2),l-1>0&&n.push(s-1),l+1<10&&n.push(s+1),l+2<10&&n.push(s+2);for(const t of n)e.add(t),Ae(a,t,e)}}for(const t of e)l[t]<4?d.add(t):h=t;p.push(v)}}const y=new ke;if(y.targetResults=p,h>0&&0!==o)y.type=9,y.needCards=[h],y.tingCount=t[h]||0;else{y.needCards=Array.from(d),y.needCards.sort((e,t)=>e-t),y.canPlayCards=Array.from(c.keys());let e=0;for(const s of y.needCards)e+=t[s]||0;y.tingCount=e,a>0?(y.type=1,c.size>0&&(y.type=7)):o>0&&(y.type=7),y.round=o}return y}function Me(e,t,s=0){if([3,6,9,12].includes(e.length)){const e=new ke;return e.type=2,e}const a=ze(e,t,s);if(8===a.type||9===a.type)return a;if([1,4,7,10,13].includes(e.length))return 13===e.length&&(a.round=0,a.needCards&&a.needCards.length>0?a.type=1:a.type=0),a.needCardGroups=[],a.canPlayCards=[],a;if(0===a.round)return a.type=4,a;if(a.canPlayCards&&a.canPlayCards.length>0){const n=Array(39).fill(0);for(const t of e)41!==t&&n[t]++;const l=[];for(const i of a.canPlayCards||[])if(4===n[i])a.type=9,a.gang=a.gang||[],a.gang.push(i);else if(9!==a.type){const n=[...e],r=n.indexOf(i);n.splice(r,1);const o=ze(n,t,s);let u=0;if(o.needCards&&0!==o.needCards.length)for(const e of o.needCards||[])u+=t[e];else{o.needCards=[...a.needCards];for(const e of o.needCards)u+=t[e]}o.tingCount=u,o.bestPlayCard=i,l.push(o)}if(9===a.type)return a.needCards=a.gang,a;l.sort((e,t)=>{const s=t.needCards?t.needCards.length:0,a=e.needCards?e.needCards.length:0;if(s!==a)return s-a;const l=t.tingCount||0,r=e.tingCount||0;if(l!==r)return l-r;const i=(n[t.bestPlayCard-1]||0)+(n[t.bestPlayCard+1]||0),o=(n[e.bestPlayCard-1]||0)+(n[e.bestPlayCard+1]||0);return i!==o?o-i:Math.abs(t.bestPlayCard%10-5)-Math.abs(e.bestPlayCard%10-5)});const r=[];for(const e of l){const t=new we;t.key=e.bestPlayCard,t.value=[...e.needCards||[]],t.tingCount=e.tingCount||0,t.round=e.round||0,r.push(t)}a.needCardGroups=r,a.type=5,a.needCardGroups.length>0&&(a.bestPlayCard=a.needCardGroups[0].key)}return a}class Ee{static analyze(e){return u(this,arguments,function*(e,t={},s=0,a={}){if(this.validateInput(e,s),!1!==a.useCache){const t=ye.get(e,s);if(t)return this.adaptResult(t,!0)}try{const n=Me(e,t,parseInt(s));return!1!==a.useCache&&ye.set(e,s,n),this.adaptResult(n,!1)}catch(n){throw new ve(ge,`算法分析失败: ${n.message}`,{originalError:n,cards:e,gameType:s})}})}static validateInput(e,t){if(!Array.isArray(e))throw new ve(me,"手牌必须是数组",{cards:e});if(e.length>14)throw new ve(me,"手牌不能超过14张",{length:e.length});const s=[0,2,3];if(!s.includes(parseInt(t)))throw new ve(fe,`无效的游戏类型: ${t}`,{gameType:t,validTypes:s})}static adaptResult(e,t=!1){const s=this.mapStatus(e.type);return{status:s,statusCode:e.type,statusText:this.getStatusText(s),tingCards:e.needCards||[],tingCount:e.tingCount||0,recommendations:this.mapRecommendations(e.needCardGroups||[]),gangCards:e.gang||[],metadata:{round:e.round||0,originalType:e.type,algorithm:"loji",cached:t,timestamp:Date.now(),canPlayCards:e.canPlayCards||[]}}}static mapStatus(e){switch(e){case 0:case 3:case 8:return"not_ready";case 1:case 5:case 7:case 9:return"ready";case 2:return"xiaoxianggong";case 4:return"winning";default:return"unknown"}}static getStatusText(e){return{not_ready:"无法胡牌",ready:"听牌",xiaoxianggong:"小相公",winning:"已胡牌",unknown:"未知状态"}[e]||"未知状态"}static mapRecommendations(e){return e&&0!==e.length?e.map((e,t)=>({id:t+1,discardTile:e.key,waitingTiles:e.value||[],waitingCount:e.tingCount||0,round:e.round||0,priority:t+1,description:this.getRecommendationDescription(e)})):[]}static getRecommendationDescription(e){const t=(e.value||[]).length,s=e.tingCount||0,a=e.round||0;return a>=2?`可进${a}听，听${t}门${s}张`:`可听${t}门${s}张`}static clearCache(){ye.clear()}static getCacheInfo(){return{size:ye.cache.size,maxSize:ye.maxSize}}}const Ie=14,Le=4,Ne=[2,5,8,11,14],Ge=0,De=2,Ze=3;function qe(e){return""}function Fe(e){if(e>=1&&e<=9)return`${e}万`;if(e>=11&&e<=19)return e-10+"筒";if(e>=21&&e<=29)return e-20+"条";if(e>=31&&e<=37){return["","东","南","西","北","中","发","白"][e-30]}return`未知牌${e}`}function Be(e){const t=document.createElement("div");t.style.cssText="\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    background: #d4edda;\n    color: #155724;\n    padding: 12px 20px;\n    border-radius: 4px;\n    border: 1px solid #c3e6cb;\n    z-index: 10000;\n    font-size: 14px;\n    max-width: 300px;\n    box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n  ",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},2e3)}function Ue(e){const t=document.createElement("div");t.style.cssText="\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    background: #f8d7da;\n    color: #721c24;\n    padding: 12px 20px;\n    border-radius: 4px;\n    border: 1px solid #f5c6cb;\n    z-index: 10000;\n    font-size: 14px;\n    max-width: 300px;\n    box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n  ",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},3e3)}function We(e){return"string"==typeof e?function(e){switch(e){case"not_ready":return"status-not-ready";case"ready":return"status-ready";case"winning":return"status-win";case"xiaoxianggong":return"status-xiaoxianggong";default:return"status-unknown"}}(e):function(e){switch(e){case 0:return"status-not-ready";case 1:return"status-ready";case 2:return"status-win";case 3:return"status-xiaoxianggong";default:return"status-unknown"}}(e)}function Ve(e){return"string"==typeof e?function(e){switch(e){case"not_ready":return"无法胡牌";case"ready":return"听牌";case"winning":return"已胡牌";case"xiaoxianggong":return"小相公";default:return"未知状态"}}(e):function(e){switch(e){case 0:return"无法胡牌";case 1:return"听牌";case 2:return"已胡牌";case 3:return"小相公";default:return"未知状态"}}(e)}function Je(e){var t;if(!e)return"";const s=e.ting_tiles||e.tingCards||[],a=e.ting_count||e.tingCount||0,n=(null==(t=e.metadata)?void 0:t.round)||0;if(0===s.length)return"";let l="";return l+=n>=2?`(${n}进听`:"(听",l+=`${s.length}门${a}张)`,l}const Ke=pe("mahjong",{state:()=>({currentHand:[],gameType:"2",isAnalyzing:!1,analysisResult:null,comparisonResult:null,handHistory:[],autoAnalyze:!0,showAlgorithmTest:!1,showGoCommandAnalysis:!1,showLojiAnalysis:!0,showHandHistory:!1,selectedTiles:[],availableTiles:[],tingRecommendations:[]}),getters:{gameTypeName:e=>{switch(e.gameType){case"0":return"普通麻将";case"2":return"红中麻将";case"3":return"258麻将";default:return"未知类型"}},tileCount:e=>t=>e.selectedTiles.filter(e=>e===t).length,canAddTile:e=>e.currentHand.length<Ie,canAnalyze:e=>{const t=e.currentHand&&e.currentHand.length>0,s=e.selectedTiles&&e.selectedTiles.length>0;return(t||s)&&!e.isAnalyzing},historyEmpty:e=>0===e.handHistory.length},actions:{addTile(e,t=!0){this.currentHand.length>=Ie?Ue("手牌已满"):(this.currentHand.push(e),this.syncHandToSelectedTiles(),this.autoAnalyze&&t&&this.analyzeHand())},removeTile(e){if(e>=0&&e<this.currentHand.length)return this.currentHand.splice(e,1),void(this.autoAnalyze&&this.analyzeHand());Ue("无效的索引")},addRandomTile(){if(this.currentHand.length>=Ie)return void Ue("手牌已满");const e=[];for(let s=1;s<=9;s++)e.push(s);for(let s=11;s<=19;s++)e.push(s);for(let s=21;s<=29;s++)e.push(s);for(let s=31;s<=37;s++)e.push(s);const t=e[Math.floor(Math.random()*e.length)];this.addTile(t,!1)},generateRandomHand(){this.currentHand=[];for(let e=0;e<Ie;e++)this.addRandomTile();this.autoAnalyze&&this.analyzeHand(),this.currentHand.sort((e,t)=>e-t)},clearHand(){this.currentHand=[],this.analysisResult=null,this.comparisonResult=null},analyzeHand(){return u(this,null,function*(){if(this.currentHand&&0!==this.currentHand.length)if(this.isAnalyzing)Ue("正在分析中，请稍候");else{this.isAnalyzing=!0,this.analysisResult=null;try{const e=this.createCardMap(),t=yield Promise.race([Ee.analyze(this.currentHand,e,this.gameType,{useCache:!0}),new Promise((e,t)=>setTimeout(()=>t(new ve(be,"分析超时")),1e4))]),s=this.adaptStandardResult(t);return this.analysisResult=s,this.addToHistory(this.currentHand,s),{success:!0,result:s}}catch(e){this.analysisResult=null;let t="分析失败";if(e instanceof ve)switch(e.code){case be:t="分析超时，请重试";break;case me:t=`手牌无效：${e.message}`;break;case fe:t=`游戏类型错误：${e.message}`;break;default:t=e.message}else t=e.message||"未知错误";Ue(t)}finally{this.isAnalyzing=!1}}else Ue("请先选择手牌")})},validateHand(){if(!Array.isArray(this.currentHand))return{valid:!1,error:"手牌数据无效"};if(0===this.currentHand.length)return{valid:!1,error:"请选择手牌"};if(this.currentHand.length>Ie)return{valid:!1,error:`手牌不能超过${Ie}张`};for(let t=0;t<this.currentHand.length;t++){const e=this.currentHand[t];if("number"!=typeof e||e<1||e>41)return{valid:!1,error:`第${t+1}张牌无效: ${e}`}}const e={};for(const t of this.currentHand)if(e[t]=(e[t]||0)+1,e[t]>4)return{valid:!1,error:`${t}这张牌数量过多（超过4张）`};return{valid:!0}},createCardMap(){const e=Array(42).fill(4);for(const t of this.currentHand)t>=1&&t<=37&&(e[t]=Math.max(0,e[t]-1));return e},adaptStandardResult(e){return e?{hu_type:this.mapStandardStatus(e.status),status:e.status,statusText:e.statusText,ting_tiles:e.tingCards||[],ting_count:e.tingCount||0,recommendations:e.recommendations||[],gang_cards:e.gangCards||[],metadata:e.metadata||{},_standard_result:e}:null},mapStandardStatus(e){switch(e){case"not_ready":default:return 0;case"ready":return 1;case"winning":return 2;case"xiaoxianggong":return 3}},processAnalysisResult(e){if(!e)return null;return{hu_type:this.mapResultType(e.type),ting_tiles:e.needCards||[],recommendations:this.mapRecommendations(e.needCardGroups||[]),original_result:e}},mapResultType(e){switch(e){case 1:case 5:return 1;case 2:return 3;case 4:case 8:return 2;default:return 0}},mapRecommendations:e=>e&&0!==e.length?e.map(e=>({key:e.key,value:e.value||[],round:e.round||1,tingCount:e.tingCount||0})):[],addToHistory(e,t){const s={id:Date.now(),hand:[...e],result:t,gameType:this.gameType,timestamp:(new Date).toLocaleString()};this.handHistory.unshift(s),this.handHistory.length>50&&(this.handHistory=this.handHistory.slice(0,50))},clearHistory(){this.handHistory=[]},loadFromHistory(e){this.currentHand=[...e.hand],this.gameType=e.gameType,this.analysisResult=e.result},toggleAutoAnalyze(){this.autoAnalyze=!this.autoAnalyze},toggleAlgorithmTest(){this.showAlgorithmTest=!this.showAlgorithmTest},toggleGoCommandAnalysis(){this.showGoCommandAnalysis=!this.showGoCommandAnalysis},toggleLojiAnalysis(){this.showLojiAnalysis=!this.showLojiAnalysis},toggleHandHistory(){this.showHandHistory=!this.showHandHistory},setGameType(e){this.gameType=e,this.autoAnalyze&&this.currentHand.length>0&&this.analyzeHand()},setSelectedTiles(e){this.selectedTiles=[...e]},addSelectedTile(e){this.selectedTiles.length>=Ie?Ue("手牌已满"):(this.selectedTiles.push(e),this.selectedTiles.sort((e,t)=>e-t))},removeSelectedTile(e){e>=0&&e<this.selectedTiles.length?this.selectedTiles.splice(e,1):Ue("无效的索引")},syncSelectedTilesToHand(){this.currentHand=[...this.selectedTiles],this.autoAnalyze&&this.analyzeHand()},syncHandToSelectedTiles(){this.selectedTiles=[...this.currentHand]},copyCurrentHand(){return u(this,null,function*(){try{const e=this.currentHand.join(",");yield navigator.clipboard.writeText(e),Be("手牌已复制到剪贴板")}catch(e){Ue("复制失败")}})}}});function Xe(){const e=Ke();return{currentHand:_(()=>e.currentHand),gameType:_(()=>e.gameType),gameTypeName:_(()=>e.gameTypeName),isAnalyzing:_(()=>e.isAnalyzing),analysisResult:_(()=>e.analysisResult),comparisonResult:_(()=>e.comparisonResult),canAddTile:_(()=>e.canAddTile),canAnalyze:_(()=>e.canAnalyze),addTile:t=>e.addTile(t),removeTile:t=>e.removeTile(t),addRandomTile:()=>e.addRandomTile(),generateRandomHand:()=>e.generateRandomHand(),clearHand:()=>e.clearHand(),analyzeHand:()=>e.analyzeHand(),copyCurrentHand:()=>e.copyCurrentHand(),setGameType:t=>e.setGameType(t)}}function Ye(){const e=Ke();return{handHistory:_(()=>e.handHistory),historyEmpty:_(()=>e.historyEmpty),addToHistory:(t,s)=>e.addToHistory(t,s),clearHistory:()=>e.clearHistory(),loadFromHistory:t=>e.loadFromHistory(t)}}function Qe(){const e=Ke();return{autoAnalyze:_(()=>e.autoAnalyze),showAlgorithmTest:_(()=>e.showAlgorithmTest),showGoCommandAnalysis:_(()=>e.showGoCommandAnalysis),showLojiAnalysis:_(()=>e.showLojiAnalysis),showHandHistory:_(()=>e.showHandHistory),toggleAutoAnalyze:()=>e.toggleAutoAnalyze(),toggleAlgorithmTest:()=>e.toggleAlgorithmTest(),toggleGoCommandAnalysis:()=>e.toggleGoCommandAnalysis(),toggleLojiAnalysis:()=>e.toggleLojiAnalysis(),toggleHandHistory:()=>e.toggleHandHistory()}}const et=d(!1),tt=d(!1);let st=null,at=null;const nt=d("light"),lt={light:{name:"浅色主题",icon:"☀️"},dark:{name:"深色主题",icon:"🌙"},auto:{name:"跟随系统",icon:"🔄"}},rt="app-theme-mode";function it(){let e=!1;switch(nt.value){case"dark":e=!0;break;case"light":e=!1;break;case"auto":e=tt.value}if(et.value=e,"undefined"!=typeof document){const t=document.documentElement;t.classList.remove("dark","light"),e?t.classList.add("dark"):t.classList.add("light"),function(e){if("undefined"==typeof document)return;const t=document.documentElement;e?(t.style.setProperty("--color-primary","#4a9eff"),t.style.setProperty("--color-primary-hover","#357abd"),t.style.setProperty("--color-success","#48bb78"),t.style.setProperty("--color-warning","#ed8936"),t.style.setProperty("--color-error","#f56565"),t.style.setProperty("--color-info","#4299e1"),t.style.setProperty("--color-background","#1a1a1a"),t.style.setProperty("--color-surface","#2d3748"),t.style.setProperty("--color-surface-hover","#4a5568"),t.style.setProperty("--color-border","#4a5568"),t.style.setProperty("--color-divider","#2d3748"),t.style.setProperty("--bg-primary","#1a1a1a"),t.style.setProperty("--bg-secondary","#2d3748"),t.style.setProperty("--bg-tertiary","#4a5568"),t.style.setProperty("--bg-quaternary","#2d3748"),t.style.setProperty("--bg-quinary","#4a5568"),t.style.setProperty("--border-color","#4a5568"),t.style.setProperty("--text-color","#e2e8f0"),t.style.setProperty("--text-secondary","#a0aec0"),t.style.setProperty("--color-text-primary","#e2e8f0"),t.style.setProperty("--color-text-secondary","#a0aec0"),t.style.setProperty("--color-text-muted","#718096"),t.style.setProperty("--color-text-inverse","#1a202c"),t.style.setProperty("--shadow-sm","0 1px 2px 0 rgba(0, 0, 0, 0.4)"),t.style.setProperty("--shadow-md","0 4px 6px -1px rgba(0, 0, 0, 0.4)"),t.style.setProperty("--shadow-lg","0 10px 15px -3px rgba(0, 0, 0, 0.4)")):(t.style.setProperty("--color-primary","#3498db"),t.style.setProperty("--color-primary-hover","#2980b9"),t.style.setProperty("--color-success","#2ecc71"),t.style.setProperty("--color-warning","#f39c12"),t.style.setProperty("--color-error","#e74c3c"),t.style.setProperty("--color-info","#17a2b8"),t.style.setProperty("--color-background","#ffffff"),t.style.setProperty("--color-surface","#f8f9fa"),t.style.setProperty("--color-surface-hover","#e9ecef"),t.style.setProperty("--color-border","#e1e5e9"),t.style.setProperty("--color-divider","#dee2e6"),t.style.setProperty("--bg-primary","#ffffff"),t.style.setProperty("--bg-secondary","#f8f9fa"),t.style.setProperty("--bg-tertiary","#e9ecef"),t.style.setProperty("--bg-quaternary","#f8f9fa"),t.style.setProperty("--bg-quinary","#e9ecef"),t.style.setProperty("--border-color","#e1e5e9"),t.style.setProperty("--text-color","#2c3e50"),t.style.setProperty("--text-secondary","#495057"),t.style.setProperty("--color-text-primary","#2c3e50"),t.style.setProperty("--color-text-secondary","#495057"),t.style.setProperty("--color-text-muted","#6c757d"),t.style.setProperty("--color-text-inverse","#ffffff"),t.style.setProperty("--shadow-sm","0 1px 2px 0 rgba(0, 0, 0, 0.05)"),t.style.setProperty("--shadow-md","0 4px 6px -1px rgba(0, 0, 0, 0.1)"),t.style.setProperty("--shadow-lg","0 10px 15px -3px rgba(0, 0, 0, 0.1)"))}(e)}}function ot(){const e=["light","dark","auto"],t=(e.indexOf(nt.value)+1)%e.length;nt.value=e[t]}function ut(e){["light","dark","auto"].includes(e)&&(nt.value=e)}function ct(){return lt[nt.value]}function dt(){x(()=>{"undefined"!=typeof window&&(st=window.matchMedia("(prefers-color-scheme: dark)"),tt.value=st.matches,at=e=>{tt.value=e.matches,it()},st.addEventListener("change",at)),function(){if("undefined"!=typeof localStorage){const e=localStorage.getItem(rt);e&&["light","dark","auto"].includes(e)&&(nt.value=e)}}(),it()});const e=()=>{st&&at&&st.removeEventListener("change",at)};return A(()=>{e()}),w(nt,()=>{it(),"undefined"!=typeof localStorage&&localStorage.setItem(rt,nt.value)}),w(tt,()=>{"auto"===nt.value&&it()}),{isDark:et,isSystemDark:tt,themeMode:nt,THEME_CONFIG:lt,toggleTheme:ot,setThemeMode:ut,getCurrentThemeConfig:ct,cleanup:e,currentThemeIcon:()=>ct().icon,currentThemeName:()=>ct().name}}const ht=(e,t)=>{const s=e.__vccOpts||e;for(const[a,n]of t)s[a]=n;return s},pt={class:"theme-toggle"},yt=["title"],vt={class:"theme-icon"},mt={class:"theme-text"},ft=["onClick"],gt={class:"option-icon"},bt={class:"option-content"},Ct={class:"option-name"},wt={class:"option-desc"},kt={key:0,class:"option-check"},Tt=ht({__name:"ThemeToggle",setup(e){const{isDark:t,themeMode:s,THEME_CONFIG:a,setThemeMode:n,currentThemeIcon:l,currentThemeName:r}=dt(),i=d(!1);function o(e){return{light:"明亮清晰，适合白天使用",dark:"深色护眼，减少眼部疲劳",work:"低调商务，适合办公场所",auto:"自动跟随系统设置"}[e]||""}function u(e){e.target.closest(".theme-toggle")||(i.value=!1)}function c(e){"Escape"===e.key&&(i.value=!1)}return x(()=>{document.addEventListener("click",u),document.addEventListener("keydown",c)}),A(()=>{document.removeEventListener("click",u),document.removeEventListener("keydown",c)}),(e,u)=>(H(),P("div",pt,[R("button",{onClick:u[0]||(u[0]=e=>i.value=!i.value),class:"theme-toggle-btn",title:`当前: ${j(r)()}, 点击切换主题`},[R("span",vt,$(j(l)()),1),R("span",mt,$({light:"日间",dark:"护眼",work:"办公",auto:"自动"}[s.value]||"主题"),1),R("span",{class:O(["theme-indicator",{dark:j(t)}])},null,2)],8,yt),i.value?(H(),P("div",{key:0,class:"theme-dropdown",onClick:u[1]||(u[1]=z(()=>{},["stop"]))},[u[2]||(u[2]=R("div",{class:"dropdown-header"},"选择主题",-1)),(H(!0),P(M,null,E(j(a),(e,t)=>(H(),P("div",{key:t,class:O(["theme-option",{active:j(s)===t}]),onClick:e=>function(e){n(e),i.value=!1}(t)},[R("span",gt,$(e.icon),1),R("div",bt,[R("div",Ct,$(e.name),1),R("div",wt,$(o(t)),1)]),j(s)===t?(H(),P("span",kt,"✓")):S("",!0)],10,ft))),128))])):S("",!0)]))}},[["__scopeId","data-v-1f4b46ed"]]),_t={class:"toolbar-container"},xt={class:"control-group basic"},At={class:"control-group advanced"},Pt=ht({__name:"ToolBar",setup(e){const{gameType:t,addRandomTile:s,generateRandomHand:a,clearHand:n,copyCurrentHand:l,setGameType:r}=Xe(),{autoAnalyze:i,toggleAutoAnalyze:o}=Qe();return Ye(),_({get:()=>t.value,set:e=>r(e)}),(e,t)=>(H(),P("div",_t,[R("div",xt,[R("button",{onClick:t[0]||(t[0]=(...e)=>j(a)&&j(a)(...e)),class:"btn btn-primary"}," 🎲 随机 "),R("button",{onClick:t[1]||(t[1]=(...e)=>j(s)&&j(s)(...e)),class:"btn btn-success"}," ➕ 加一 "),R("button",{onClick:t[2]||(t[2]=(...e)=>j(l)&&j(l)(...e)),class:"btn btn-warning"}," 📋 复制 "),R("button",{onClick:t[3]||(t[3]=(...e)=>j(n)&&j(n)(...e)),class:"btn btn-secondary"}," 🗑️ 清空 ")]),R("div",At,[R("button",{onClick:t[4]||(t[4]=(...e)=>j(o)&&j(o)(...e)),class:O(["btn",j(i)?"btn-success":"btn-outline"])},$(j(i)?"🔍 自动分析开":"🔍 自动分析关"),3)])]))}},[["__scopeId","data-v-c599ab41"]]),Ht={class:"app-header"},Rt={class:"header-content"},St={class:"toolbar-section"},$t={class:"header-actions"},jt=ht({__name:"Header",setup:e=>(e,t)=>(H(),P("header",Ht,[R("div",Rt,[R("div",St,[I(Pt)]),R("div",$t,[I(Tt)])])]))},[["__scopeId","data-v-fc79b1de"]]),Ot={class:"main-content"},zt={class:"content-container"},Mt=ht({__name:"MainContent",setup:e=>(e,t)=>(H(),P("main",Ot,[R("div",zt,[L(e.$slots,"default",{},void 0)])]))},[["__scopeId","data-v-5f449caa"]]),Et={class:"hand-display-footer"},It={class:"footer-content"},Lt={class:"selected-tiles"},Nt=["onClick"],Gt=["src","alt"],Dt={class:"selected-tile blank"},Zt=ht({__name:"Footer",setup(e){const{currentHand:t,removeTile:s}=Xe();return(e,a)=>{var n;return H(),P("footer",Et,[R("div",It,[R("div",Lt,[(H(!0),P(M,null,E(j(t),(e,t)=>(H(),P("div",{key:t,class:"selected-tile",onClick:e=>j(s)(t)},[R("img",{src:j(qe)(e),alt:j(Fe)(e)},null,8,Gt)],8,Nt))),128)),(H(!0),P(M,null,E(14-(null==(n=j(t))?void 0:n.length),e=>(H(),P("div",Dt," X "))),256))])])])}}},[["__scopeId","data-v-2fa569d9"]]),qt={class:"history-panel"},Ft={class:"panel-header"},Bt={key:0,class:"empty-history"},Ut={key:1,class:"history-list"},Wt=["onClick"],Vt={class:"history-header"},Jt={class:"history-time"},Kt={class:"history-stats"},Xt={class:"tile-count"},Yt={class:"game-type"},Qt={class:"history-hand"},es={class:"hand-tiles"},ts=["src","alt"],ss={key:0,class:"history-analysis"},as={key:0,class:"ting-info"},ns={key:2,class:"history-actions"},ls=ht({__name:"HistoryPanel",setup(e){const{handHistory:t,historyEmpty:s,clearHistory:a,loadFromHistory:n}=Ye(),{toggleHandHistory:l}=Qe(),r=e=>{switch("string"==typeof e?parseInt(e):e){case Ge:return"普通";case De:return"红中";case Ze:return"258";default:return"未知"}},i=e=>Ve(e);return(e,o)=>(H(),P("div",qt,[R("div",Ft,[R("h3",null,"📜 手牌历史记录 ("+$(j(t).length)+"/50)",1),R("button",{onClick:o[0]||(o[0]=(...e)=>j(l)&&j(l)(...e)),class:"close-btn"},"×")]),j(s)?(H(),P("div",Bt,o[2]||(o[2]=[R("p",null,"暂无历史记录",-1),R("small",null,"分析手牌后会自动保存到历史记录中",-1)]))):(H(),P("div",Ut,[(H(!0),P(M,null,E(j(t),e=>{return H(),P("div",{key:e.id,class:"history-item",onClick:t=>j(n)(e)},[R("div",Vt,[R("span",Jt,$(e.timestamp),1),R("div",Kt,[R("span",Xt,$(e.hand.length)+"张牌",1),R("span",Yt,$(r(e.gameType)),1)])]),R("div",Qt,[R("div",es,[(H(!0),P(M,null,E(e.hand.slice(0,14),(e,t)=>(H(),P("img",{key:t,src:j(qe)(e),alt:j(Fe)(e),class:"tile-img"},null,8,ts))),128))])]),e.result?(H(),P("div",ss,[R("span",{class:O(["analysis-status",(t=e.result.hu_type,We(t))])},$(i(e.result.hu_type)),3),e.result.ting_tiles&&e.result.ting_tiles.length>0?(H(),P("span",as," 听"+$(e.result.ting_tiles.length)+"张 ",1)):S("",!0)])):S("",!0)],8,Wt);var t}),128))])),j(s)?S("",!0):(H(),P("div",ns,[R("button",{onClick:o[1]||(o[1]=(...e)=>j(a)&&j(a)(...e)),class:"btn btn-danger"}," 🗑️ 清空历史记录 ")]))]))}},[["__scopeId","data-v-af5ccfab"]]),rs="http://127.0.0.1:8000";function is(e){return u(this,arguments,function*(e,t=3,s=1e3){try{return yield e()}catch(a){if(t>0)return yield new Promise(e=>setTimeout(e,s)),is(e,t-1,s);throw a}})}function os(e){return u(this,arguments,function*(e,t={}){return is(()=>u(null,null,function*(){try{const s=yield function(e,t={},s=1e4){return new Promise((a,n)=>{const l=setTimeout(()=>{n(new Error(`请求超时: ${s}ms`))},s);fetch(e,t).then(e=>{clearTimeout(l),a(e)}).catch(e=>{clearTimeout(l),n(e)})})}(`${rs}/analyze`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({hand:e,config:t})});if(!s.ok){const e=yield s.text();throw new Error(`HTTP ${s.status}: ${e||s.statusText}`)}const a=yield s.json();return o(i({},a),{raw_response:a,request_info:{url:`${rs}/analyze`,method:"POST",hand:e,options:t,timestamp:(new Date).toISOString()}})}catch(s){throw s}})).catch(e=>({error:e.message,status:"error",results:{},details:{error_type:e.name,error_message:e.message,traceback:e.stack}}))})}function us(e){return u(this,arguments,function*(e,t={}){const s=performance.now();try{if(!function(e){if(!e||!Array.isArray(e)||0===e.length)return!1;if(e.length>14)return!1;for(const s of e)if(!Number.isInteger(s)||s<1||s>41)return!1;const t={};for(const s of e)if(t[s]=(t[s]||0)+1,t[s]>4)return!1;return!0}(e))throw new Error("手牌格式不合法");const a=yield os(e,t),n=performance.now()-s,l={};a.results&&"object"==typeof a.results?Object.keys(a.results).forEach(e=>{a.results[e]&&(l[e]=o(i({},a.results[e]),{_source:"python-backend",_raw_response:a}))}):a.error&&(l["mahjong-repository"]={library:"mahjong-repository",status:"error",execution_time:0,error:a.error,details:a.details||{},_source:"python-backend",_raw_response:a});const r=Object.values(l).filter(e=>e&&"success"===e.status).length,u=Object.keys(l).length,c=r>0?Object.values(l).filter(e=>e&&"success"===e.status&&"number"==typeof e.execution_time).reduce((e,t)=>e+t.execution_time,0)/r:0,d=Object.values(l).filter(e=>e&&"success"===e.status&&null!==e.shanten&&void 0!==e.shanten).map(e=>e.shanten);return{hand:e,results:l,summary:{total_libraries:u,successful_calculations:r,failed_calculations:u-r,available_libraries:u,average_execution_time:c,total_execution_time:n,consistency:{shanten_values:[...new Set(d)],consensus_shanten:cs(l)},analysis_options:t},timestamp:(new Date).toISOString(),locale_timestamp:(new Date).toLocaleString("zh-CN")}}catch(a){return{hand:e,results:{},error:{message:a.message,type:a.name,stack:a.stack},summary:{total_libraries:0,successful_calculations:0,available_libraries:0,average_execution_time:0,error_occurred:!0},timestamp:(new Date).toISOString(),locale_timestamp:(new Date).toLocaleString("zh-CN")}}})}function cs(e){const t=Object.values(e).filter(e=>"success"===e.status&&null!==e.shanten&&void 0!==e.shanten).map(e=>e.shanten);if(0===t.length)return null;const s={};t.forEach(e=>{s[e]=(s[e]||0)+1});let a=0,n=null;return Object.entries(s).forEach(([e,t])=>{t>a&&(a=t,n=parseInt(e))}),n}const ds={class:"algorithm-test"},hs={class:"control-panel"},ps=["disabled"],ys=["disabled"],vs=["disabled"],ms=["disabled"],fs=["disabled"],gs={class:"test-config"},bs=["disabled"],Cs=["disabled"],ws={class:"test-options"},ks={class:"options-grid"},Ts=["disabled"],_s=["disabled"],xs=["disabled"],As={key:0,class:"progress-section"},Ps={class:"progress-bar"},Hs={class:"progress-info"},Rs={key:0},Ss={class:"stats-grid"},$s={class:"stat-card"},js={class:"stat-value"},Os={class:"stat-card success"},zs={class:"stat-value"},Ms={key:0,class:"stat-percent"},Es={class:"stat-card warning"},Is={class:"stat-value"},Ls={key:0,class:"stat-percent"},Ns={class:"stat-card error"},Gs={class:"stat-value"},Ds={key:0,class:"stat-percent"},Zs={class:"stat-card"},qs={class:"stat-value"},Fs={class:"stat-card"},Bs={class:"stat-value"},Us={key:1,class:"error-logs"},Ws={class:"log-list"},Vs={class:"log-time"},Js={class:"log-message"},Ks=["onClick"],Xs={key:2,class:"discrepancies-section"},Ys={class:"count"},Qs={class:"discrepancy-stats"},ea={class:"pattern-grid"},ta={class:"pattern-title"},sa={class:"pattern-count"},aa={class:"pattern-percent"},na={class:"discrepancies-list"},la=["onClick"],ra={class:"expand-icon"},ia={class:"disc-content"},oa={class:"hand-display"},ua={class:"hand-array"},ca={class:"results"},da={key:0,class:"result-item"},ha={class:"value"},pa={key:1,class:"result-item"},ya={class:"value"},va={key:0,class:"disc-details"},ma={class:"detail-grid"},fa={class:"detail-item"},ga={class:"detail-item"},ba={class:"detail-item"},Ca=["onClick"],wa={class:"error-detail"},ka={key:0},Ta=ht({__name:"AlgorithmTest",setup(e){const t=d(!1),s=d(!1),a=d(200),n=d(50),l=d(null),r=d(null),i=d({}),o=d(!1),c=v({usePythonBackend:!0,useNiuAlgorithm:!0,showRealtimeResults:!1}),h=d({tested:0,matches:0,discrepancies:0,errors:0}),p=d([]),y=d([]),m=us,f=d(!1),g=d(null);x(()=>u(null,null,function*(){}));const b=_(()=>a.value>0?h.value.tested/a.value*100:0),C=_(()=>p.value.slice(-20).reverse()),k=_(()=>y.value.slice(-10).reverse()),T=_(()=>{if(!l.value||0===h.value.tested)return"0";const e=(Date.now()-l.value)/1e3;return Math.floor(h.value.tested/e).toString()}),A=_(()=>{if(!l.value)return"00:00";const e=Math.floor((Date.now()-l.value)/1e3),t=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`}),j=_(()=>{if(!l.value||0===h.value.tested)return"--";const e=(Date.now()-l.value)/1e3,t=h.value.tested/e,s=(a.value-h.value.tested)/t;if(s<60)return`${Math.floor(s)}秒`;return`${Math.floor(s/60)}:${Math.floor(s%60).toString().padStart(2,"0")}`}),I=_(()=>{const e={};return p.value.forEach(t=>{const s=L(t);e[s]||(e[s]={count:0,title:s}),e[s].count++}),Object.values(e).forEach(e=>{e.percent=(e.count/p.value.length*100).toFixed(1)}),e});function L(e){var t,s;const a=null==(s=null==(t=e.pythonResults)?void 0:t["mahjong-repository"])?void 0:s.shanten,n=e.niuAlgorithmResult;return void 0!==a&&void 0!==n?a!==n?`Python:${a} vs Niu:${n}`:"结果一致":void 0!==a?"Python有结果，Niu无结果":void 0!==n?"Niu有结果，Python无结果":"两者都无结果"}function B(){const e=[],t=[];for(let s=1;s<=9;s++)for(let e=0;e<4;e++)t.push(s);for(let s=11;s<=19;s++)for(let e=0;e<4;e++)t.push(s);for(let s=21;s<=29;s++)for(let e=0;e<4;e++)t.push(s);for(let s=31;s<=37;s++)for(let e=0;e<4;e++)t.push(s);for(let s=0;s<14;s++){const s=Math.floor(Math.random()*t.length);e.push(t[s]),t.splice(s,1)}return e.sort((e,t)=>e-t)}function U(e){const t=[];for(const s of e)if(s>=1&&s<=9)t.push(s+"万");else if(s>=11&&s<=19)t.push(s-10+"筒");else if(s>=21&&s<=29)t.push(s-20+"条");else if(s>=31&&s<=37){const e=["东","南","西","北","白","发","中"];t.push(e[s-31])}return t.join(" ")}function W(e){return u(this,null,function*(){var t;const s={hand:e,results:{},niuAlgorithmResult:void 0,errors:[]};try{if(c.usePythonBackend)try{const t=yield m(e);t&&t.results?Object.keys(t.results).forEach(e=>{t.results[e]&&void 0!==t.results[e].shanten&&(s.results[e]=t.results[e].shanten)}):t.error&&s.errors.push({library:"python-backend",error:t.error})}catch(a){s.errors.push({library:"python-backend",error:a.message})}if(c.useNiuAlgorithm)try{const t=e.map(e=>e-1),a=Me(t,Array(37).fill(4),0);a&&void 0!==a.round?s.niuAlgorithmResult=a.round:s.errors.push({library:"niuAlgorithm",error:"No valid result"})}catch(a){s.errors.push({library:"niuAlgorithm",error:a.message})}const n=Object.values(s.results).filter(e=>null!=e),l=void 0!==s.niuAlgorithmResult;if(n.length>=1||l){const a=null==(t=s.results["mahjong-repository"])?void 0:t.shanten,n=s.niuAlgorithmResult;let l=!1;void 0!==a&&void 0!==n&&a!==n&&(l=!0),l?(h.value.discrepancies++,p.value.push({number:h.value.discrepancies,hand:e,handStr:U(e),pythonResults:s.results,niuAlgorithmResult:s.niuAlgorithmResult,timestamp:(new Date).toLocaleTimeString()})):h.value.matches++,c.showRealtimeResults}else h.value.errors++,y.value.push({time:(new Date).toLocaleTimeString(),message:"分析失败: 没有有效结果",hand:e,results:s.results,niuAlgorithmResult:s.niuAlgorithmResult,errors:s.errors})}catch(a){h.value.errors++,y.value.push({time:(new Date).toLocaleTimeString(),message:a.message,hand:e,stack:a.stack})}h.value.tested++})}const V=[{id:1,name:"标准听牌",hand:[1,1,1,2,3,4,5,6,7,11,11,11,31],expected:{shanten:0,isWinning:!1,winningTiles:[2,5,8]}},{id:2,name:"已胡牌型",hand:[1,1,1,2,2,2,3,3,3,4,4,4,5,5],expected:{shanten:-1,isWinning:!0,winType:"标准和牌"}},{id:3,name:"七对子听牌",hand:[1,1,3,3,5,5,7,7,11,11,13,13,31],expected:{shanten:0,isWinning:!1,winType:"七对子听牌"}},{id:4,name:"国士无双听牌",hand:[1,9,11,19,21,29,31,32,33,34,35,36,37],expected:{shanten:0,isWinning:!1,winType:"国士无双听牌"}},{id:5,name:"一向听经典",hand:[1,2,3,4,5,6,8,9,11,12,13,21,21,22],expected:{shanten:1,isWinning:!1,winType:"1向听"}},{id:6,name:"二向听复杂",hand:[1,3,5,7,9,12,14,16,23,25,27,31,33,35],expected:{shanten:2,isWinning:!1,winType:"2向听"}},{id:7,name:"边界测试",hand:[1,1,1,1,9,9,9,9,31,31,31,31,37,37],expected:{shanten:3,isWinning:!1,winType:"特殊构造"}},{id:8,name:"特别牌型",hand:[1,2,3,3,12,14,15,15,16,18,23,29,32,34],expected:{shanten:3,isWinning:!1,winType:"特别牌型"}}];function J(){return u(this,null,function*(){if(!t.value||s.value)return;const e=[];o.value||(yield function(){return u(this,null,function*(){const e=[];for(const t of V)e.push(W(t.hand));yield Promise.all(e),o.value=!0})}());const l=Math.min(n.value,a.value-h.value.tested);for(let t=0;t<l;t++){const t=B();e.push(W(t))}yield Promise.all(e),t.value&&!s.value&&h.value.tested<a.value?requestAnimationFrame(()=>{J()}):h.value.tested>=a.value&&function(){t.value=!1,s.value=!1;Be(`测试完成！\n已测试: ${h.value.tested}\n完全一致: ${h.value.matches} (${(h.value.matches/h.value.tested*100).toFixed(2)}%)\n发现差异: ${h.value.discrepancies} (${(h.value.discrepancies/h.value.tested*100).toFixed(2)}%)\n错误: ${h.value.errors} (${(h.value.errors/h.value.tested*100).toFixed(2)}%)\n用时: ${A.value}`)}()})}function K(){c.usePythonBackend||c.useNiuAlgorithm?(t.value=!0,s.value=!1,l.value=Date.now(),h.value={tested:0,matches:0,discrepancies:0,errors:0},p.value=[],y.value=[],i.value={},o.value=!1,J()):showError("请至少启用一个算法进行测试")}function X(){s.value=!s.value,!s.value&&t.value&&J()}function Y(){t.value=!1,s.value=!1,r.value&&(clearTimeout(r.value),r.value=null)}function Q(){h.value={tested:0,matches:0,discrepancies:0,errors:0},p.value=[],y.value=[],i.value={},l.value=null,o.value=!1}function ee(){const e={summary:{totalTested:h.value.tested,matches:h.value.matches,discrepancies:h.value.discrepancies,errors:h.value.errors,matchRate:(h.value.matches/h.value.tested*100).toFixed(2)+"%",timestamp:(new Date).toISOString(),testDuration:A.value,testOptions:c},discrepancyPatterns:I.value,discrepancies:p.value,errorLogs:y.value},t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),s=URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download=`algorithm-test-results-${(new Date).toISOString().split("T")[0]}.json`,a.click(),URL.revokeObjectURL(s)}function te(){f.value=!1,g.value=null}return N(()=>{r.value&&clearTimeout(r.value)}),w(c,()=>{c.usePythonBackend||c.useNiuAlgorithm||(c.usePythonBackend=!0)}),(e,l)=>{var r;return H(),P("div",ds,[l[33]||(l[33]=R("div",{class:"test-header"},[R("h2",null,"算法对比测试"),R("p",{class:"description"}," 对比 Python后端(MahjongRepository) 和 niuAlgorithm 的向听数计算结果 ")],-1)),R("div",hs,[R("button",{class:"btn btn-primary",onClick:K,disabled:t.value},$(t.value?"测试中...":"开始测试"),9,ps),R("button",{class:"btn btn-secondary",onClick:X,disabled:!t.value},$(s.value?"继续":"暂停"),9,ys),R("button",{class:"btn btn-danger",onClick:Y,disabled:!t.value}," 停止测试 ",8,vs),R("button",{class:"btn btn-secondary",onClick:Q,disabled:t.value||0===p.value.length}," 清除结果 ",8,ms),R("button",{class:"btn btn-success",onClick:ee,disabled:0===p.value.length}," 导出结果 ",8,fs),R("div",gs,[R("label",null,[l[6]||(l[6]=G(" 测试数量： ")),D(R("input",{type:"number","onUpdate:modelValue":l[0]||(l[0]=e=>a.value=e),min:"100",max:"100000",step:"100",disabled:t.value},null,8,bs),[[Z,a.value,void 0,{number:!0}]])]),R("label",null,[l[7]||(l[7]=G(" 批次大小： ")),D(R("input",{type:"number","onUpdate:modelValue":l[1]||(l[1]=e=>n.value=e),min:"10",max:"1000",step:"10",disabled:t.value},null,8,Cs),[[Z,n.value,void 0,{number:!0}]])])])]),R("div",ws,[l[11]||(l[11]=R("h3",null,"测试选项",-1)),R("div",ks,[R("label",null,[D(R("input",{type:"checkbox","onUpdate:modelValue":l[2]||(l[2]=e=>c.usePythonBackend=e),disabled:t.value},null,8,Ts),[[q,c.usePythonBackend]]),l[8]||(l[8]=G(" 使用 Python 后端 (MahjongRepository) "))]),R("label",null,[D(R("input",{type:"checkbox","onUpdate:modelValue":l[3]||(l[3]=e=>c.useNiuAlgorithm=e),disabled:t.value},null,8,_s),[[q,c.useNiuAlgorithm]]),l[9]||(l[9]=G(" 使用 niuAlgorithm (JavaScript) "))]),R("label",null,[D(R("input",{type:"checkbox","onUpdate:modelValue":l[4]||(l[4]=e=>c.showRealtimeResults=e),disabled:t.value},null,8,xs),[[q,c.showRealtimeResults]]),l[10]||(l[10]=G(" 显示实时结果 "))])])]),h.value.tested>0||t.value?(H(),P("div",As,[R("div",Ps,[R("div",{class:O(["progress-fill",{paused:s.value}]),style:F({width:b.value+"%"})},$(b.value.toFixed(1))+"% ",7)]),R("div",Hs,[R("span",null,$(h.value.tested)+" / "+$(a.value),1),"--"!==j.value?(H(),P("span",Rs,"预计剩余时间: "+$(j.value),1)):S("",!0)])])):S("",!0),R("div",Ss,[R("div",$s,[R("div",js,$(h.value.tested),1),l[12]||(l[12]=R("div",{class:"stat-label"},"已测试",-1))]),R("div",Os,[R("div",zs,$(h.value.matches),1),l[13]||(l[13]=R("div",{class:"stat-label"},"完全一致",-1)),h.value.tested>0?(H(),P("div",Ms,$((h.value.matches/h.value.tested*100).toFixed(1))+"% ",1)):S("",!0)]),R("div",Es,[R("div",Is,$(h.value.discrepancies),1),l[14]||(l[14]=R("div",{class:"stat-label"},"发现差异",-1)),h.value.tested>0?(H(),P("div",Ls,$((h.value.discrepancies/h.value.tested*100).toFixed(1))+"% ",1)):S("",!0)]),R("div",Ns,[R("div",Gs,$(h.value.errors),1),l[15]||(l[15]=R("div",{class:"stat-label"},"错误",-1)),h.value.tested>0?(H(),P("div",Ds,$((h.value.errors/h.value.tested*100).toFixed(1))+"% ",1)):S("",!0)]),R("div",Zs,[R("div",qs,$(T.value),1),l[16]||(l[16]=R("div",{class:"stat-label"},"速度(手/秒)",-1))]),R("div",Fs,[R("div",Bs,$(A.value),1),l[17]||(l[17]=R("div",{class:"stat-label"},"已用时间",-1))])]),y.value.length>0?(H(),P("div",Us,[l[18]||(l[18]=R("h3",null,"错误日志 (最新 10 条)",-1)),R("div",Ws,[(H(!0),P(M,null,E(k.value,(e,t)=>(H(),P("div",{key:t,class:"log-item"},[R("span",Vs,$(e.time),1),R("span",Js,$(e.message),1),R("button",{onClick:t=>{return s=e,g.value=s,void(f.value=!0);var s},class:"btn-link"},"详情",8,Ks)]))),128))])])):S("",!0),p.value.length>0?(H(),P("div",Xs,[R("h3",null,[l[19]||(l[19]=G(" 发现的差异 ")),R("span",Ys,"(总计: "+$(p.value.length)+", 显示最新 "+$(Math.min(20,p.value.length))+" 个)",1)]),R("div",Qs,[l[20]||(l[20]=R("h4",null,"差异模式分析",-1)),R("div",ea,[(H(!0),P(M,null,E(I.value,(e,t)=>(H(),P("div",{key:t,class:"pattern-card"},[R("div",ta,$(e.title),1),R("div",sa,$(e.count)+" 次",1),R("div",aa,$(e.percent)+"%",1)]))),128))])]),R("div",na,[(H(!0),P(M,null,E(C.value,(e,t)=>{var s;return H(),P("div",{key:t,class:O(["discrepancy-item",{expanded:i.value[e.number]}])},[R("div",{class:"disc-header",onClick:t=>{return s=e.number,void(i.value[s]=!i.value[s]);var s}},[R("strong",null,"差异 #"+$(e.number),1),R("span",ra,$(i.value[e.number]?"▼":"▶"),1)],8,la),R("div",ia,[R("div",oa,[l[21]||(l[21]=R("span",{class:"label"},"手牌:",-1)),G(" "+$(e.handStr),1)]),R("div",ua,[l[22]||(l[22]=R("span",{class:"label"},"数组:",-1)),G(" ["+$(e.hand.join(", "))+"] ",1)]),R("div",ca,[e.pythonResults?(H(),P("div",da,[l[23]||(l[23]=R("span",{class:"lib-name"},"MahjongRepository:",-1)),R("span",ha,$((null==(s=e.pythonResults["mahjong-repository"])?void 0:s.shanten)||"N/A")+"向听",1)])):S("",!0),void 0!==e.niuAlgorithmResult?(H(),P("div",pa,[l[24]||(l[24]=R("span",{class:"lib-name"},"niuAlgorithm:",-1)),R("span",ya,$(e.niuAlgorithmResult)+"向听",1)])):S("",!0)]),i.value[e.number]?(H(),P("div",va,[l[28]||(l[28]=R("h5",null,"详细分析",-1)),R("div",ma,[R("div",fa,[l[25]||(l[25]=R("span",{class:"label"},"测试时间:",-1)),R("span",null,$(e.timestamp||(new Date).toLocaleTimeString()),1)]),R("div",ga,[l[26]||(l[26]=R("span",{class:"label"},"差异类型:",-1)),R("span",null,$(L(e)),1)]),R("div",ba,[l[27]||(l[27]=R("span",{class:"label"},"牌数:",-1)),R("span",null,$(e.hand.length)+"张",1)])]),R("button",{onClick:t=>function(e){return u(this,null,function*(){showError('请使用"库数据分析"功能深入分析此手牌:\n'+e.hand.join(" "))})}(e),class:"btn btn-sm btn-info"}," 深入分析此手牌 ",8,Ca)])):S("",!0)])],2)}),128))])])):S("",!0),l[34]||(l[34]=R("div",{class:"info-section"},[R("h3",null,"测试说明"),R("ul",null,[R("li",null,"测试将分批进行，每批处理指定数量的手牌"),R("li",null,"可以随时暂停、继续或停止测试"),R("li",null,"发现差异时会记录详细信息供分析"),R("li",null,"建议先进行小批量测试（如1000手）来评估性能")])],-1)),f.value?(H(),P("div",{key:3,class:"modal-overlay",onClick:te},[R("div",{class:"modal-content",onClick:l[5]||(l[5]=z(()=>{},["stop"]))},[l[32]||(l[32]=R("h3",null,"错误详情",-1)),R("div",wa,[R("p",null,[l[29]||(l[29]=R("strong",null,"时间:",-1)),G(" "+$(g.value.time),1)]),R("p",null,[l[30]||(l[30]=R("strong",null,"错误信息:",-1)),G(" "+$(g.value.message),1)]),R("p",null,[l[31]||(l[31]=R("strong",null,"手牌:",-1)),G(" "+$(null==(r=g.value.hand)?void 0:r.join(" ")),1)]),g.value.stack?(H(),P("pre",ka,$(g.value.stack),1)):S("",!0)]),R("button",{onClick:te,class:"btn btn-secondary"},"关闭")])])):S("",!0)])}}},[["__scopeId","data-v-6275ccd0"]]);const _a=new class{constructor(){this.baseURL="http://localhost:8000",this.timeout=3e4,this.stats={totalRequests:0,successfulRequests:0,failedRequests:0,totalResponseTime:0,averageResponseTime:0}}request(e){return u(this,arguments,function*(e,t={}){const s=Date.now(),a=new AbortController,n=setTimeout(()=>a.abort(),this.timeout);try{this.stats.totalRequests++;const l=yield fetch(`${this.baseURL}${e}`,o(i({},t),{signal:a.signal,headers:i({"Content-Type":"application/json",Accept:"application/json"},t.headers)}));if(clearTimeout(n),!l.ok)throw new Error(`HTTP error! status: ${l.status}`);const r=yield l.json(),u=Date.now()-s;return this.stats.successfulRequests++,this.stats.totalResponseTime+=u,this.stats.averageResponseTime=this.stats.totalResponseTime/this.stats.successfulRequests,{success:!0,data:r,responseTime:u,timestamp:(new Date).toISOString()}}catch(l){return clearTimeout(n),this.stats.failedRequests++,{success:!1,error:l.message,responseTime:Date.now()-s,timestamp:(new Date).toISOString()}}})}analyzeHand(e){return u(this,null,function*(){const t={hand:e,config:{}};return yield this.request("/go-analyze",{method:"POST",body:JSON.stringify(t)})})}checkHealth(){return u(this,null,function*(){try{return(yield this.request("/health",{method:"GET"})).success}catch(e){return!1}})}getStats(){return o(i({},this.stats),{successRate:this.stats.totalRequests>0?(this.stats.successfulRequests/this.stats.totalRequests*100).toFixed(2)+"%":"0%"})}resetStats(){this.stats={totalRequests:0,successfulRequests:0,failedRequests:0,totalResponseTime:0,averageResponseTime:0}}},xa={class:"go-command-analysis"},Aa={class:"analysis-header"},Pa={class:"analysis-controls"},Ha=["disabled"],Ra={key:0,class:"input-info"},Sa={class:"info-item"},$a={class:"value"},ja={class:"info-item"},Oa={class:"value go-format"},za={class:"info-item"},Ma={class:"value"},Ea={class:"info-item"},Ia={key:1,class:"error-message"},La={key:0,class:"error-details"},Na={key:2,class:"analysis-result"},Ga={key:0,class:"result-section"},Da={class:"parsed-result"},Za={key:0,class:"result-item"},qa={class:"result-value shanten"},Fa={key:1,class:"analysis-lines"},Ba={class:"analysis-list"},Ua={key:2,class:"improvements"},Wa={class:"improvement-list"},Va={class:"result-section"},Ja={class:"raw-output"},Ka={key:0,class:"raw-content"},Xa={class:"result-section"},Ya={class:"stats-grid"},Qa={class:"stat-item"},en={class:"stat-item"},tn={class:"stat-value"},sn={class:"stat-item"},an={class:"stat-value"},nn={class:"stat-item"},ln={class:"stat-value"},rn={key:3,class:"usage-info"},on=ht({__name:"GoCommandAnalysis",setup(e){const{currentHand:t}=Xe(),s=d(!1),a=d(null),n=d(null),l=d(!1),r=()=>u(null,null,function*(){if(t.value&&0!==t.value.length){s.value=!0,n.value=null,a.value=null;try{const e=yield _a.analyzeHand(t.value);e.success?(a.value=e.data,"error"===e.data.status&&(n.value=e.data.error)):n.value=e.error||"分析失败"}catch(e){n.value=e.message||"分析异常"}finally{s.value=!1}}else n.value="请先选择手牌"}),i=()=>{a.value=null,n.value=null,l.value=!1},o=()=>{l.value=!l.value},c=e=>({success:"成功",error:"错误",timeout:"超时",pending:"处理中"}[e]||"未知");return w(t,e=>{a.value=null,n.value=null,l.value=!1},{deep:!0}),(e,s)=>(H(),P("div",xa,[R("div",Aa,[s[0]||(s[0]=R("h3",null,"🎯 Go命令行分析",-1)),R("div",Pa,[R("button",{onClick:r,class:"analyze-btn"}," 深度分析 "),R("button",{onClick:i,disabled:!a.value,class:"clear-btn"}," 清除结果 ",8,Ha)])]),a.value?(H(),P("div",Ra,[R("div",Sa,[s[1]||(s[1]=R("span",{class:"label"},"输入手牌:",-1)),R("span",$a,$(j(t).length)+"张",1)]),R("div",ja,[s[2]||(s[2]=R("span",{class:"label"},"Go格式:",-1)),R("span",Oa,$(a.value.go_tiles),1)]),R("div",za,[s[3]||(s[3]=R("span",{class:"label"},"执行时间:",-1)),R("span",Ma,$((1e3*a.value.execution_time).toFixed(0))+"ms",1)]),R("div",Ea,[s[4]||(s[4]=R("span",{class:"label"},"状态:",-1)),R("span",{class:O(["value","status",a.value.status])},$(c(a.value.status)),3)])])):S("",!0),n.value||a.value&&"error"===a.value.status?(H(),P("div",Ia,[R("p",null,"❌ 分析失败: "+$(n.value||a.value.error),1),a.value&&"error"===a.value.status?(H(),P("div",La,s[5]||(s[5]=[R("p",{class:"error-hint"},"可能的原因：",-1),R("ul",null,[R("li",null,"Go工具文件不存在或权限不足"),R("li",null,"手牌格式不正确"),R("li",null,"Python后端连接失败")],-1)]))):S("",!0)])):S("",!0),a.value&&"success"===a.value.status?(H(),P("div",Na,[a.value.parsed_result?(H(),P("div",Ga,[s[9]||(s[9]=R("h4",null,"📊 分析结果",-1)),R("div",Da,[null!==a.value.parsed_result.shanten?(H(),P("div",Za,[s[6]||(s[6]=R("span",{class:"result-label"},"向听数:",-1)),R("span",qa,$(a.value.parsed_result.shanten),1)])):S("",!0),a.value.parsed_result.analysis&&a.value.parsed_result.analysis.length>0?(H(),P("div",Fa,[s[7]||(s[7]=R("h5",null,"分析详情:",-1)),R("div",Ba,[(H(!0),P(M,null,E(a.value.parsed_result.analysis,(e,t)=>(H(),P("div",{key:t,class:"analysis-line"},$(e),1))),128))])])):S("",!0),a.value.parsed_result.improvements&&a.value.parsed_result.improvements.length>0?(H(),P("div",Ua,[s[8]||(s[8]=R("h5",null,"改良建议:",-1)),R("div",Wa,[(H(!0),P(M,null,E(a.value.parsed_result.improvements,(e,t)=>(H(),P("div",{key:t,class:"improvement-item"},$(e),1))),128))])])):S("",!0)])])):S("",!0),R("div",Va,[s[10]||(s[10]=R("h4",null,"📝 原始输出",-1)),R("div",Ja,[R("button",{onClick:o,class:"toggle-btn"},$(l.value?"隐藏":"显示")+" 原始输出 ",1),l.value?(H(),P("pre",Ka,$(a.value.raw_output),1)):S("",!0)])]),R("div",Xa,[s[15]||(s[15]=R("h4",null,"📈 执行统计",-1)),R("div",Ya,[R("div",Qa,[s[11]||(s[11]=R("span",{class:"stat-label"},"执行状态:",-1)),R("span",{class:O(["stat-value",a.value.status])},$(c(a.value.status)),3)]),R("div",en,[s[12]||(s[12]=R("span",{class:"stat-label"},"处理时间:",-1)),R("span",tn,$((1e3*a.value.execution_time).toFixed(0))+"ms",1)]),R("div",sn,[s[13]||(s[13]=R("span",{class:"stat-label"},"分析时间:",-1)),R("span",an,$(a.value.timestamp),1)]),R("div",nn,[s[14]||(s[14]=R("span",{class:"stat-label"},"输出行数:",-1)),R("span",ln,$(a.value.raw_output.split("\n").length),1)])])])])):S("",!0),a.value?S("",!0):(H(),P("div",rn,s[16]||(s[16]=[R("h4",null,"💡 使用说明",-1),R("p",null,"这个功能直接调用Go麻将工具的命令行接口，提供专业的手牌分析。",-1),R("ul",null,[R("li",null,"支持标准14张手牌分析"),R("li",null,"提供向听数计算"),R("li",null,"给出详细的分析建议"),R("li",null,"显示原始Go工具输出")],-1),R("p",{class:"note"}," 注意：需要确保Python后端正在运行，且Go工具文件存在。 ",-1)])))]))}},[["__scopeId","data-v-007eb7ba"]]),un={class:"loji-analysis"},cn={class:"hand-selection"},dn={class:"tile-pool"},hn={class:"tile-category"},pn={class:"tile-row"},yn=["onClick"],vn=["src","alt"],mn={class:"tile-count"},fn={class:"tile-category"},gn={class:"tile-row"},bn=["onClick"],Cn=["src","alt"],wn={class:"tile-count"},kn={class:"tile-category"},Tn={class:"tile-row"},_n=["onClick"],xn=["src","alt"],An={class:"tile-count"},Pn={class:"tile-category"},Hn={class:"tile-row"},Rn=["onClick"],Sn=["src","alt"],$n={class:"tile-count"},jn={class:"analysis-controls"},On=["disabled"],zn={key:0,class:"analysis-result"},Mn={class:"result-header"},En={key:0,class:"listening-info"},In={class:"listening-tiles"},Ln=["src","alt"],Nn={class:"tile-name"},Gn={key:0,class:"ting-summary"},Dn={class:"ting-stat"},Zn={class:"stat-value"},qn={class:"ting-stat"},Fn={class:"stat-value"},Bn={key:1,class:"recommendations"},Un={class:"recommendation-list"},Wn={key:0,class:"round-header"},Vn={class:"round-label"},Jn={class:"recommendation-item"},Kn={class:"discard-tile"},Xn=["src","alt"],Yn={class:"recommendation-info"},Qn={class:"progress-text"},el={class:"waiting-tiles"},tl=["src","alt"],sl={key:0,class:"cache-indicator"},al={key:2,class:"win-info"},nl={class:"win-details"},ll={key:0,class:"hu-info"},rl={class:"hu-label"},il={class:"hu-value"},ol=ht({__name:"LojiAnalysis",setup(e){const{currentHand:t,isAnalyzing:s,analysisResult:a,analyzeHand:n,canAnalyze:l,addTile:r}=Xe(),o=_(()=>{var e;return(null==(e=a.value)?void 0:e.recommendations)?a.value.recommendations.map(e=>i({id:e.id||Date.now()+Math.random(),discardTile:e.discardTile||e.key,waitingTiles:e.waitingTiles||e.value||[],waitingCount:e.waitingCount||e.tingCount||0,round:e.round||0,priority:e.priority||1,description:e.description||"",cached:e.cached||!1},e)):[]});_(()=>function(e){if(!e)return"未分析";const t=Ve(e.status||e.hu_type),s=e.ting_tiles||e.tingCards||[],a=e.recommendations||[];let n=t;return s.length>0&&(n+=`，听${s.length}张牌`),a.length>0&&(n+=`，${a.length}个推荐`),n}(a.value));const c=_(()=>{if(!a.value)return!1;if(!(1===a.value.hu_type||"ready"===a.value.status))return!1;const e=t.value.length;if(Ne.includes(e))return!1;return(a.value.ting_tiles||[]).length>0}),d=e=>t.value.filter(t=>t===e).length,h=e=>{if(t.value.length>=Ie)return void Ue("手牌已满");t.value.filter(t=>t===e).length>=Le?Ue("此牌已达到最大数量"):r(e)},p=(e,t)=>{if(0===t)return!0;const s=o.value[t-1];return e.round!==(null==s?void 0:s.round)},y=e=>e.description?e.description:function(e){if(!e)return"";const{waitingCount:t=0,waitingTiles:s=[],round:a=0,description:n}=e;if(n)return n;const l=s.length;return a>=2?`可进${a}听，听${l}门${t}张`:`可听${l}门${t}张`}(e),v=e=>e.waitingTiles||e.value||[],m=()=>u(null,null,function*(){if(!(t.value&&t.value.length>0))return void Ue("请先选择手牌");const e=t.value.length;if(e>14)Ue("手牌不能超过14张");else if(0!==e)try{const e=yield n();e&&e.success?Be("分析完成"):Ue((null==e?void 0:e.message)||"分析失败")}catch(s){Ue("分析过程中发生错误，请重试")}else Ue("请选择至少一张牌")}),f=e=>Ve(e);return(e,t)=>{var n,r;return H(),P("div",un,[t[7]||(t[7]=R("div",{class:"analysis-header"},null,-1)),R("div",cn,[R("div",dn,[R("div",hn,[R("div",pn,[(H(),P(M,null,E(9,e=>R("div",{key:`man-${e}`,class:O(["tile-option",{disabled:d(e)>=4}]),onClick:t=>h(e)},[R("img",{src:j(qe)(e),alt:`${e}万`},null,8,vn),R("span",mn,$(4-d(e)),1)],10,yn)),64))])]),R("div",fn,[R("div",gn,[(H(),P(M,null,E(9,e=>R("div",{key:`pin-${e}`,class:O(["tile-option",{disabled:d(e+10)>=4}]),onClick:t=>h(e+10)},[R("img",{src:j(qe)(e+10),alt:`${e}筒`},null,8,Cn),R("span",wn,$(4-d(e+10)),1)],10,bn)),64))])]),R("div",kn,[R("div",Tn,[(H(),P(M,null,E(9,e=>R("div",{key:`sou-${e}`,class:O(["tile-option",{disabled:d(e+20)>=4}]),onClick:t=>h(e+20)},[R("img",{src:j(qe)(e+20),alt:`${e}条`},null,8,xn),R("span",An,$(4-d(e+20)),1)],10,_n)),64))])]),R("div",Pn,[R("div",Hn,[(H(),P(M,null,E(["东","南","西","北","中","发","白"],(e,t)=>R("div",{key:`honor-${t}`,class:O(["tile-option",{disabled:d(31+t)>=4}]),onClick:e=>h(31+t)},[R("img",{src:j(qe)(31+t),alt:e},null,8,Sn),R("span",$n,$(4-d(31+t)),1)],10,Rn)),64))])])])]),R("div",jn,[R("button",{onClick:m,disabled:!j(l)||j(s),class:"btn btn-primary"},$(j(s)?"🔍 分析中...":"🔍 分析听牌"),9,On)]),j(a)?(H(),P("div",zn,[R("div",Mn,[R("h4",null,"分析结果 "+$(c.value?j(Je)(j(a)):""),1),R("div",{class:O(["result-status",(r=j(a).hu_type,We(r))])},$(f(j(a).hu_type)),3)]),c.value?(H(),P("div",En,[R("h5",null,"🎯 听牌 "+$(j(Je)(j(a))),1),R("div",In,[(H(!0),P(M,null,E(j(a).ting_tiles||[],e=>(H(),P("div",{key:e,class:"listening-tile"},[R("img",{src:j(qe)(e),alt:j(Fe)(e)},null,8,Ln),R("span",Nn,$(j(Fe)(e)),1)]))),128))]),j(a).metadata||j(a).ting_count?(H(),P("div",Gn,[R("div",Dn,[t[0]||(t[0]=R("span",{class:"stat-label"},"进听数：",-1)),R("span",Zn,$((null==(n=j(a).metadata)?void 0:n.round)||1)+"进听",1)]),R("div",qn,[t[1]||(t[1]=R("span",{class:"stat-label"},"听牌数：",-1)),R("span",Fn,$((j(a).ting_tiles||[]).length)+"门"+$(j(a).ting_count||0)+"张",1)])])):S("",!0)])):S("",!0),j(a).recommendations&&j(a).recommendations.length>0?(H(),P("div",Bn,[t[4]||(t[4]=R("h5",null,"🎯 推荐打牌",-1)),R("div",Un,[(H(!0),P(M,null,E(o.value,(e,s)=>(H(),P("div",{key:e.id||s,class:"recommendation-group"},[p(e,s)?(H(),P("div",Wn,[R("span",Vn,$(e.round||1)+"进听",1),t[2]||(t[2]=R("div",{class:"round-divider"},null,-1))])):S("",!0),R("div",Jn,[R("div",Kn,[t[3]||(t[3]=R("span",{class:"action-label"},"打",-1)),R("img",{src:j(qe)(e.discardTile||e.key),alt:j(Fe)(e.discardTile||e.key)},null,8,Xn)]),R("div",Yn,[R("span",Qn,$(y(e)),1),R("div",el,[(H(!0),P(M,null,E(v(e),e=>(H(),P("img",{key:e,src:j(qe)(e),alt:j(Fe)(e),class:"wait-tile"},null,8,tl))),128))]),e.cached?(H(),P("div",sl," ⚡ 缓存结果 ")):S("",!0)])])]))),128))])])):S("",!0),2===j(a).hu_type?(H(),P("div",al,[t[6]||(t[6]=R("h5",null,"🎉 胡牌",-1)),R("div",nl,[t[5]||(t[5]=R("p",null,"恭喜！当前手牌已经胡牌",-1)),j(a).hu_info?(H(),P("div",ll,[(H(!0),P(M,null,E(j(a).hu_info,(e,t)=>(H(),P("div",{key:t,class:"hu-detail"},[R("span",rl,$(t)+":",1),R("span",il,$(e),1)]))),128))])):S("",!0)])])):S("",!0)])):S("",!0)])}}},[["__scopeId","data-v-8ab882d6"]]),ul={TOAST_ICONS:{success:"✅",warning:"⚠️",error:"❌",info:"ℹ️"}},cl=e=>ul.TOAST_ICONS[e]||ul.TOAST_ICONS.info,dl={class:"toast-content"},hl={class:"toast-icon"},pl={class:"toast-text"},yl={class:"toast-message"},vl={key:0,class:"toast-subtitle"},ml={key:0,class:"toast-progress"},fl=ht({__name:"Toast",props:{show:{type:Boolean,default:!1},message:{type:String,default:""},subtitle:{type:String,default:""},type:{type:String,default:"info",validator:e=>["success","warning","error","info"].includes(e)},persistent:{type:Boolean,default:!1},closable:{type:Boolean,default:!0},duration:{type:Number,default:3e3}},emits:["close"],setup:e=>(t,s)=>(H(),B(W,{name:"toast",appear:""},{default:U(()=>[e.show?(H(),P("div",{key:0,class:O(["toast",`toast-${e.type}`,{"toast-persistent":e.persistent}])},[R("div",dl,[R("span",hl,$(j(cl)(e.type)),1),R("div",pl,[R("span",yl,$(e.message),1),e.subtitle?(H(),P("span",vl,$(e.subtitle),1)):S("",!0)]),!e.persistent||e.closable?(H(),P("button",{key:0,onClick:s[0]||(s[0]=e=>t.$emit("close")),class:"toast-close"},"×")):S("",!0)]),!e.persistent&&e.duration>0?(H(),P("div",ml,[R("div",{class:"toast-progress-bar",style:F({animationDuration:`${e.duration}ms`})},null,4)])):S("",!0)],2)):S("",!0)]),_:1}))},[["__scopeId","data-v-791041b6"]]),gl={class:"simple-mahjong-app"},bl={class:"analysis-content"},Cl=ht({__name:"App",setup(e){dt();const{showAlgorithmTest:t,showGoCommandAnalysis:s,showLojiAnalysis:a,showHandHistory:n}=Qe();return(e,l)=>(H(),P("div",gl,[I(jt),I(Mt,null,{default:U(()=>[j(t)?(H(),B(Ta,{key:0})):S("",!0),j(s)?(H(),B(on,{key:1})):S("",!0),j(a)?(H(),B(ol,{key:2})):S("",!0),R("div",bl,[j(n)?(H(),B(ls,{key:0})):S("",!0)])]),_:1}),I(fl),I(Zt)]))}},[["__scopeId","data-v-2e973eec"]]),wl=function(){const e=c(!0),t=e.run(()=>d({}));let s=[],a=[];const n=h({install(e){K(n),n._a=e,e.provide(X,n),e.config.globalProperties.$pinia=n,a.forEach(e=>s.push(e)),a=[]},use(e){return this._a?s.push(e):a.push(e),this},_p:s,_a:null,_e:e,_s:new Map,state:t});return n}(),kl=V(Cl);kl.use(wl),kl.mount("#app");
