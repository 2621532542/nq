var e=Object.defineProperty,s=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,t=(s,a,l)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):s[a]=l;import{r as n,c as i,o as r,a as c,b as o,e as u,f as d,t as v,n as p,l as y,F as m,m as f,u as g,k as h,E as b,w as k,G as w,H as x,p as C,s as _,v as z,g as I,T as P,i as T,h as A,y as E,j as S}from"./vendor.G8ViXyKc.js";import{_ as D,u as q,a as j,g as M,H as N,s as R,b as $,c as Q,d as H,e as L,f as O,h as K,N as F,L as X,i as U,j as B,k as V,l as W}from"./index.y6HLDFeu.js";const G={class:"tile-pool-wrapper"},Y={class:"header-hint"},J={class:"tile-pool"},Z={key:0,class:"suit-tabs"},ee=["onClick"],se=["data-suit"],ae={class:"tile-row"},le=["disabled","onClick","title"],te=["src","alt"],ne={class:"tile-remain"},ie=D({__name:"TilePool",emits:["tile-selected"],setup(e,{emit:s}){const a=s,{currentHand:l,addTile:t}=q(),h=j(),b=n("man"),k=n(!1),w=i({get:()=>h.tilePoolCollapsed,set:e=>h.tilePoolCollapsed=e}),x=[{key:"man",label:"ä¸‡",tiles:Array.from({length:9},(e,s)=>({code:s+1,name:`${s+1}ä¸‡`}))},{key:"pin",label:"ç­’",tiles:Array.from({length:9},(e,s)=>({code:s+11,name:`${s+1}ç­’`}))},{key:"sou",label:"æ¡",tiles:Array.from({length:9},(e,s)=>({code:s+21,name:`${s+1}æ¡`}))},{key:"honor",label:"å­—",tiles:[{code:31,name:"ä¸œ"},{code:32,name:"å—"},{code:33,name:"è¥¿"},{code:34,name:"åŒ—"},{code:35,name:"ä¸­"},{code:36,name:"å‘"},{code:37,name:"ç™½"}]}],C=i(()=>k.value?x.filter(e=>e.key===b.value):x),_=e=>l.value.filter(s=>s===e).length,z=()=>{const e=k.value;k.value=window.innerWidth<=768,!e&&k.value&&(w.value=!0)};return r(()=>{z(),window.addEventListener("resize",z)}),c(()=>{window.removeEventListener("resize",z)}),(e,s)=>(u(),o("div",G,[d("div",{class:"pool-header",onClick:s[0]||(s[0]=e=>w.value=!w.value)},[s[1]||(s[1]=d("span",{class:"header-icon"},"ğŸ€„",-1)),s[2]||(s[2]=d("span",{class:"header-title"},"é€‰ç‰ŒåŒº",-1)),d("span",Y,v(w.value?"ç‚¹å‡»å±•å¼€":"ç‚¹å‡»æ”¶èµ·"),1),d("span",{class:p(["collapse-icon",{collapsed:w.value}])},"â–¼",2)]),d("div",{class:p(["tile-pool-collapse",{collapsed:w.value}])},[d("div",J,[k.value?(u(),o("div",Z,[(u(),o(m,null,f(x,e=>d("button",{key:e.key,class:p(["suit-tab",{active:b.value===e.key}]),onClick:s=>b.value=e.key},v(e.label),11,ee)),64))])):y("",!0),d("div",{class:p(["pool-content",{mobile:k.value}])},[(u(!0),o(m,null,f(C.value,e=>(u(),o("div",{key:e.key,class:"tile-category","data-suit":e.key},[d("div",ae,[(u(!0),o(m,null,f(e.tiles,e=>(u(),o("button",{key:e.code,class:p(["tile-btn",{disabled:_(e.code)>=4}]),disabled:_(e.code)>=4,onClick:s=>{return n=e.code,void(l.value.length>=N.MAX?R("æ‰‹ç‰Œå·²æ»¡"):_(n)>=4?R("æ­¤ç‰Œå·²è¾¾åˆ°æœ€å¤§æ•°é‡"):(t(n),a("tile-selected",n)));var n},title:e.name},[d("img",{src:g(M)(e.code),alt:e.name},null,8,te),d("span",ne,v(4-_(e.code)),1)],10,le))),128))])],8,se))),128))],2)])],2)]))}},[["__scopeId","data-v-232abb27"]]),re={class:"quiz-overlay"},ce={class:"quiz-panel"},oe={class:"quiz-timer"},ue={class:"quick-select",role:"group","aria-label":"å¬ç‰Œé€‰æ‹©"},de=["aria-pressed","aria-label","onClick"],ve=["aria-pressed","aria-label"],pe=D({__name:"QuizPanel",props:{elapsedTime:{type:[Number,String],default:0}},emits:["submit","prev","next"],setup(e,{emit:s}){const a=h("feedback",null),l=s,t=n(""),i=n(null),c=b(new Set),y=e=>{null==a||a.haptic.selection(),c.has(e)?c.delete(e):c.add(e),g()},g=()=>{const e=Array.from(c);e.sort((e,s)=>36===e?1:36===s?-1:e-s),t.value=e.join(",")},_=e=>{const s=new Set,a=e.split(/[,\s]+/).filter(e=>e.trim());for(const l of a){const e=l.trim();if("å‘"!==e&&"fa"!==e)if(/^\d+$/.test(e)){let a=0;for(;a<e.length;)if(a+1<e.length&&"36"===e.substring(a,a+2))s.add(36),a+=2;else{const l=parseInt(e[a]);l>=1&&l<=9&&s.add(l),a+=1}}else{const a=parseInt(e);36===a?s.add(36):a>=1&&a<=9&&s.add(a)}else s.add(36)}return s};k(t,e=>{const s=_(e);c.clear();for(const a of s)c.add(a)});const z=()=>{const e=_(t.value),s=Array.from(e).sort((e,s)=>36===e?1:36===s?-1:e-s);l("submit",s.join(","))},I=e=>{""===t.value.trim()&&("ArrowLeft"===e.code?(e.preventDefault(),t.value="",c.clear(),l("prev")):"ArrowRight"===e.code&&(e.preventDefault(),t.value="",c.clear(),l("next")))};return r(()=>{var e;null==(e=i.value)||e.focus()}),(s,a)=>(u(),o("div",re,[d("div",ce,[a[2]||(a[2]=d("h4",null,"â“ é—®ç­”æ¨¡å¼",-1)),a[3]||(a[3]=d("p",{class:"quiz-hint"},"è¯·è¾“å…¥ä½ è®¤ä¸ºçš„å¬ç‰Œï¼ˆç‚¹å‡»é€‰æ‹©æˆ–æ‰‹åŠ¨è¾“å…¥ï¼‰",-1)),d("p",oe,"â±ï¸ è®¡æ—¶ä¸­... "+v(e.elapsedTime)+"ç§’",1),d("div",ue,[(u(),o(m,null,f(9,e=>d("button",{key:e,class:p(["tile-btn",{selected:c.has(e)}]),"aria-pressed":c.has(e),"aria-label":`${e}ä¸‡${c.has(e)?"ï¼Œå·²é€‰ä¸­":""}`,onClick:s=>y(e)},v(e),11,de)),64)),d("button",{class:p(["tile-btn tile-fa",{selected:c.has(36)}]),"aria-pressed":c.has(36),"aria-label":"å‘è´¢"+(c.has(36)?"ï¼Œå·²é€‰ä¸­":""),onClick:a[0]||(a[0]=e=>y(36))}," å‘ ",10,ve)]),w(d("input",{ref_key:"inputRef",ref:i,"onUpdate:modelValue":a[1]||(a[1]=e=>t.value=e),type:"text",class:"quiz-input",placeholder:"è¾“å…¥: 1234 æˆ– 336 æˆ– 1,2,3",onKeyup:C(z,["enter"]),onKeydown:I},null,544),[[x,t.value]]),d("button",{onClick:z,class:"btn btn-submit"}," âœ… å¯¹æ¯”ç­”æ¡ˆ ")])]))}},[["__scopeId","data-v-b58ba082"]]),ye={key:0,class:"celebration"},me={class:"result-icon"},fe={class:"result-title"},ge={class:"quiz-duration"},he={class:"quiz-answers"},be={class:"answer-row"},ke={class:"answer-value user-answer"},we={class:"answer-row"},xe={class:"answer-value correct-answer"},Ce=D({__name:"QuizResult",props:{result:{type:Object,default:null}},emits:["next"],setup(e){const s=e,a=h("feedback",null);k(()=>s.result,e=>{e&&a&&(e.correct?a.haptic.success():a.haptic.error())},{immediate:!0});const l=e=>Array.isArray(e)?e.join(", "):e;return(s,a)=>(u(),_(P,{name:"result-pop"},{default:z(()=>[e.result?(u(),o("div",{key:0,class:p(["quiz-result-panel",{correct:e.result.correct,wrong:!e.result.correct}])},[e.result.correct?(u(),o("div",ye,a[1]||(a[1]=[d("span",{class:"confetti"},"ğŸ‰",-1),d("span",{class:"confetti"},"âœ¨",-1),d("span",{class:"confetti"},"ğŸŠ",-1)]))):y("",!0),d("div",me,v(e.result.correct?"âœ…":"âŒ"),1),d("h4",fe,v(e.result.correct?"å›ç­”æ­£ç¡®ï¼":"å›ç­”é”™è¯¯"),1),d("p",ge,"â±ï¸ ç”¨æ—¶: "+v(e.result.duration)+" ç§’",1),d("div",he,[d("div",be,[a[2]||(a[2]=d("span",{class:"answer-label"},"ä½ çš„ç­”æ¡ˆ:",-1)),d("span",ke,v(l(e.result.userAnswer)||"æ— "),1)]),d("div",we,[a[3]||(a[3]=d("span",{class:"answer-label"},"æ­£ç¡®ç­”æ¡ˆ:",-1)),d("span",xe,v(l(e.result.correctAnswer)),1)])]),d("button",{onClick:a[0]||(a[0]=e=>s.$emit("next")),class:"btn btn-next"}," â¡ï¸ ä¸‹ä¸€é¢˜ "),a[4]||(a[4]=d("p",{class:"space-hint"},[I(" æŒ‰ "),d("kbd",null,"ç©ºæ ¼"),I(" é”®å¿«é€Ÿè¿›å…¥ä¸‹ä¸€é¢˜ ")],-1))],2)):y("",!0)]),_:1}))}},[["__scopeId","data-v-b9a2b178"]]),_e={key:0,class:"discard-quiz-overlay"},ze={class:"discard-quiz-panel"},Ie={class:"quiz-timer"},Pe={key:0,class:"celebration"},Te={class:"result-icon"},Ae={class:"result-title"},Ee={class:"quiz-duration"},Se={class:"comparison-section"},De={class:"comparison-item your-choice"},qe={class:"comparison-tile"},je=["src","alt"],Me={key:0,class:"comparison-info"},Ne={class:"shanten"},Re={class:"ting-count"},$e={class:"rank"},Qe={key:1,class:"comparison-info"},He={class:"comparison-tile"},Le=["src","alt"],Oe={key:0,class:"comparison-info"},Ke={class:"shanten"},Fe={class:"ting-count"},Xe={class:"action-btns"},Ue=D({__name:"DiscardQuizPanel",props:{result:{type:Object,default:null},elapsedTime:{type:[Number,String],default:0}},emits:["retry","next"],setup(e){const s=e,a=h("feedback",null);return k(()=>s.result,e=>{e&&a&&(e.correct?a.haptic.success():a.haptic.error())},{immediate:!0}),(s,a)=>(u(),o(m,null,[e.result?y("",!0):(u(),o("div",_e,[d("div",ze,[a[2]||(a[2]=d("h4",null,"ğŸ¯ èˆç‰Œç»ƒä¹ ",-1)),a[3]||(a[3]=d("p",{class:"quiz-hint"},"è¯·åœ¨ä¸‹æ–¹æ‰‹ç‰Œä¸­ç‚¹å‡»é€‰æ‹©è¦æ‰“å‡ºçš„ç‰Œ",-1)),d("p",Ie,"â±ï¸ è®¡æ—¶ä¸­... "+v(e.elapsedTime)+"ç§’",1),a[4]||(a[4]=d("div",{class:"action-hint"},[d("span",{class:"hint-icon"},"ğŸ‘‡"),d("span",null,"ç‚¹å‡»åº•éƒ¨æ‰‹ç‰Œé€‰æ‹©èˆç‰Œ")],-1))])])),T(P,{name:"result-pop"},{default:z(()=>{var l,t;return[e.result?(u(),o("div",{key:0,class:p(["discard-result-panel",{correct:e.result.correct,wrong:!e.result.correct}])},[e.result.correct?(u(),o("div",Pe,a[5]||(a[5]=[d("span",{class:"confetti"},"ğŸ‰",-1),d("span",{class:"confetti"},"âœ¨",-1),d("span",{class:"confetti"},"ğŸŠ",-1)]))):y("",!0),d("div",Te,v(e.result.correct?"âœ…":"âŒ"),1),d("h4",Ae,v(e.result.correct?"é€‰æ‹©æ­£ç¡®ï¼":"å¯ä»¥æ›´å¥½"),1),d("p",Ee,"â±ï¸ ç”¨æ—¶: "+v(e.result.duration)+" ç§’",1),d("div",Se,[d("div",De,[a[7]||(a[7]=d("div",{class:"comparison-label"},"ä½ çš„é€‰æ‹©",-1)),d("div",qe,[d("img",{src:g(M)(e.result.userDiscard),alt:g($)(e.result.userDiscard)},null,8,je)]),e.result.userInfo?(u(),o("div",Me,[d("span",Ne,v(e.result.userInfo.round)+"å‘å¬",1),d("span",Re,v((null==(l=e.result.userInfo.waitingTiles)?void 0:l.length)||0)+"é—¨"+v(e.result.userInfo.waitingCount||e.result.userInfo.tingCount||0)+"å¼  ",1),d("span",$e,"ç¬¬"+v(e.result.userRank)+"å",1)])):(u(),o("div",Qe,a[6]||(a[6]=[d("span",{class:"no-info"},"ä¸åœ¨æ¨èåˆ—è¡¨ä¸­",-1)])))]),a[10]||(a[10]=d("div",{class:"vs"},"VS",-1)),d("div",{class:p(["comparison-item best-choice",{same:e.result.correct}])},[a[9]||(a[9]=d("div",{class:"comparison-label"},"æœ€ä¼˜é€‰æ‹©",-1)),d("div",He,[d("img",{src:g(M)(e.result.bestDiscard),alt:g($)(e.result.bestDiscard)},null,8,Le)]),e.result.bestInfo?(u(),o("div",Oe,[d("span",Ke,v(e.result.bestInfo.round)+"å‘å¬",1),d("span",Fe,v((null==(t=e.result.bestInfo.waitingTiles)?void 0:t.length)||0)+"é—¨"+v(e.result.bestInfo.waitingCount||e.result.bestInfo.tingCount||0)+"å¼  ",1),a[8]||(a[8]=d("span",{class:"rank"},"ç¬¬1å",-1))])):y("",!0)],2)]),d("div",Xe,[d("button",{onClick:a[0]||(a[0]=e=>s.$emit("retry")),class:"btn btn-retry"}," ğŸ”„ é‡åš "),d("button",{onClick:a[1]||(a[1]=e=>s.$emit("next")),class:"btn btn-next"}," â¡ï¸ ä¸‹ä¸€é¢˜ ")]),a[11]||(a[11]=d("p",{class:"space-hint"},[I(" æŒ‰ "),d("kbd",null,"ç©ºæ ¼"),I(" é”®å¿«é€Ÿè¿›å…¥ä¸‹ä¸€é¢˜ ")],-1))],2)):y("",!0)]}),_:1})],64))}},[["__scopeId","data-v-dc865228"]]),Be={class:"efficiency-chart"},Ve={class:"chart-header"},We=["disabled"],Ge={key:0},Ye={key:1},Je={key:0,class:"depth-progress"},Ze={class:"progress-bar"},es={class:"progress-text"},ss={class:"chart-container"},as=["onClick","onMouseenter"],ls={class:"discard-tile"},ts=["src","alt"],ns={key:0,class:"shanten-badge"},is={class:"bar-wrapper"},rs={class:"bar-value"},cs={class:"wait-tiles"},os=["src","alt"],us={class:"tooltip-title"},ds={class:"tooltip-content"},vs={key:0,class:"tooltip-shanten"},ps={class:"tooltip-row"},ys={class:"tooltip-expect-section"},ms={class:"tooltip-expect-row"},fs={class:"value"},gs={key:0,class:"badge best"},hs={key:1,class:"badge worse"},bs={class:"tooltip-expect-row stability-row"},ks={class:"value"},ws={key:0,class:"tooltip-details-section"},xs={class:"details-list"},Cs={class:"detail-card"},_s={class:"detail-calc"},zs={class:"details-summary"},Is={key:1,class:"tooltip-compare-section"},Ps={class:"compare-row"},Ts={class:"compare-row"},As={class:"worse"},Es={key:0,class:"compare-reason"},Ss={key:2,class:"tooltip-missed-section"},Ds={key:0,class:"tooltip-reason best"},qs={key:1,class:"tooltip-hint"},js={key:3,class:"best-label"},Ms=D({__name:"EfficiencyChart",props:{items:{type:Array,default:()=>[]}},setup(e){const r=e,c=j(),{currentHand:h,removeTileByCode:b}=q(),k=i(()=>{var e;return(null==(e=c.depthAnalysisState)?void 0:e.isCalculating)||!1}),w=i(()=>{var e;return(null==(e=c.analysisProgress)?void 0:e.percent)||50}),x=i(()=>{var e;return(null==(e=c.analysisProgress)?void 0:e.text)||"è®¡ç®—æœŸæœ›ä¸­..."}),C=()=>{c.calculateDepthExpect()},z=n(-1),P=n(-1),T=n(0),S=n(0),D=i(()=>P.value<0?null:K.value[P.value]);function N(){P.value=-1}function H(e){L(e)}function L(e){const s=15,a=window.innerWidth,l=window.innerHeight;let t=e.clientX+s,n=e.clientY+10;t+360>a&&(t=e.clientX-360-s),n+500>l&&(n=l-500-s),t<s&&(t=s),n<s&&(n=s),T.value=t,S.value=n}const O=i(()=>{var e;return(null==(e=c.analysisResult)?void 0:e.recommendations)||[]}),K=i(()=>{const e=O.value.length>0?O.value:r.items;return(null==e?void 0:e.length)?[...e].map(e=>{var n;return((e,n)=>{for(var i in n||(n={}))a.call(n,i)&&t(e,i,n[i]);if(s)for(var i of s(n))l.call(n,i)&&t(e,i,n[i]);return e})({id:e.id||Date.now()+Math.random(),discardTile:e.discardTile||e.key,waitingTiles:e.waitingTiles||e.value||[],waitingCount:e.waitingCount||e.tingCount||0,round:null!=(n=e.round)?n:99,twoStepExpect:e.twoStepExpect||0},e)}):[]}),F=i(()=>0===K.value.length?1:Math.max(...K.value.map(e=>X(e)),1));function X(e){var s,a;return e.waitingCount||e.tingCount||(null==(s=e.waitingTiles)?void 0:s.length)||(null==(a=e.value)?void 0:a.length)||0}function U(e){return e.round}function B(e){return e.twoStepExpect||0}function V(e){return e.missedDraws||[]}function W(e){const s=K.value[0];if(!s)return 0;return 1===e.round?(s.twoStepExpect||0)-(e.twoStepExpect||0):0}function G(){const e=K.value[0];return e?X(e):0}function Y(){const e=K.value[0];return e&&e.twoStepExpect||0}function J(e){return e.expectDetails||[]}function Z(e){return Math.round(X(e)/F.value*100)}function ee(e){return e.waitingTiles||e.value||[]}function se(e){return 0===e?"rank-1":1===e?"rank-2":2===e?"rank-3":""}return(e,s)=>{return u(),o("div",Be,[d("div",Ve,[s[0]||(s[0]=d("h5",{class:"chart-title"},[I("ğŸ¯ ç‰Œæ•ˆå¯¹æ¯” "),d("span",{class:"hint"},"(ç‚¹å‡»æ‰“å‡º)")],-1)),d("button",{class:p(["depth-btn",{calculating:k.value}]),disabled:k.value,onClick:C,title:"ç«‹å³åŒæ­¥è®¡ç®—ä¸¤æ­¥æœŸæœ›å€¼"},[k.value?(u(),o("span",Ge,"â³ è®¡ç®—ä¸­...")):(u(),o("span",Ye,"ğŸ“Š è®¡ç®—æœŸæœ›"))],10,We)]),k.value?(u(),o("div",Je,[d("div",Ze,[d("div",{class:"progress-fill",style:A({width:w.value+"%"})},null,4)]),d("span",es,v(x.value),1)])):y("",!0),d("div",ss,[(u(!0),o(m,null,f(K.value,(e,s)=>(u(),o("div",{key:e.id||s,class:p(["chart-row",{best:0===s,selected:z.value===s}]),onClick:a=>function(e,s){const a=e.discardTile||e.key;h.value.includes(a)?(z.value=s,b(a),Q(`æ‰“å‡º ${$(a)}`)):R("æ‰‹ç‰Œä¸­æ²¡æœ‰è¿™å¼ ç‰Œ")}(e,s),onMouseenter:e=>function(e,s){P.value=s,L(e)}(e,s),onMouseleave:N,onMousemove:H},[d("span",{class:p(["rank-badge",se(s)])},v(s+1),3),d("div",ls,[d("img",{src:g(M)(e.discardTile||e.key),alt:g($)(e.discardTile||e.key)},null,8,ts)]),void 0!==U(e)?(u(),o("div",ns,v(U(e))+"å‘å¬ ",1)):y("",!0),d("div",is,[d("div",{class:p(["bar",{"bar-best":0===s}]),style:A({width:Z(e)+"%"})},[d("span",rs,v(ee(e).length)+"é—¨"+v(X(e))+"å¼ ",1)],6)]),d("div",cs,[(u(!0),o(m,null,f(ee(e),e=>(u(),o("img",{key:e,src:g(M)(e),alt:g($)(e),class:"wait-tile"},null,8,os))),128))])],42,as))),128))]),(u(),_(E,{to:"body"},[P.value>=0&&D.value?(u(),o("div",{key:0,class:"tooltip",style:A({left:T.value+"px",top:S.value+"px"})},[d("div",us,"æ‰“ "+v(g($)(D.value.discardTile||D.value.key)),1),d("div",ds,[void 0!==U(D.value)?(u(),o("div",vs,v(U(D.value))+"å‘å¬ ",1)):y("",!0),d("div",ps,"ğŸ“Š å½“å‰è¿›å¼ : "+v(ee(D.value).length)+"é—¨"+v(X(D.value))+"å¼ ",1),1===U(D.value)&&B(D.value)>0?(u(),o(m,{key:1},[d("div",ys,[d("div",ms,[s[1]||(s[1]=d("span",{class:"label"},"ä¸¤æ­¥æœŸæœ›:",-1)),d("span",fs,v(B(D.value)),1),0===P.value?(u(),o("span",gs,"æœ€ä¼˜")):(u(),o("span",hs,"-"+v(W(D.value)),1))]),d("div",bs,[s[2]||(s[2]=d("span",{class:"label"},"ç¨³å®šæ€§:",-1)),d("span",ks,v((a=D.value,((a.twoStepExpect||0)/(X(a)||1)).toFixed(1))),1),s[3]||(s[3]=d("span",{class:"stability-note"},"(æ¯å¼ è¿›å¼ å¹³å‡å¬ç‰Œæ•°)",-1))])]),J(D.value).length>0?(u(),o("div",ws,[s[4]||(s[4]=d("div",{class:"details-title"},"ğŸ“‹ è¿›å¼ åˆ†æ (è¿›ç‰Œ Ã— å¬ç‰Œ = è´¡çŒ®):",-1)),d("div",xs,[(u(!0),o(m,null,f(J(D.value),e=>(u(),o("div",{key:e.card,class:p(["detail-row",{"low-ting":e.tingCount<4,"high-ting":e.tingCount>=8}])},[d("span",Cs,v(g($)(e.card)),1),d("span",_s,[I(v(e.count)+"å¼  Ã— "+v(e.tingCount)+"å¼  = ",1),d("strong",null,v(e.contribution),1)])],2))),128))]),d("div",zs," åˆè®¡: "+v(B(D.value)),1)])):y("",!0),P.value>0?(u(),o("div",Is,[s[7]||(s[7]=d("div",{class:"compare-title"},"ğŸ“Š ä¸ç¬¬ä¸€åå·®è·:",-1)),d("div",Ps,[s[5]||(s[5]=d("span",null,"å½“å‰è¿›å¼ :",-1)),d("span",{class:p(X(D.value)>=G()?"better":"worse")},[I(v(X(D.value))+"å¼  ",1),X(D.value)!==G()?(u(),o(m,{key:0},[I(" ("+v(X(D.value)>G()?"+":"")+v(X(D.value)-G())+") ",1)],64)):y("",!0)],2)]),d("div",Ts,[s[6]||(s[6]=d("span",null,"ä¸¤æ­¥æœŸæœ›:",-1)),d("span",As,[I(v(B(D.value))+" vs "+v(Y())+" ",1),d("strong",null,"(-"+v(W(D.value))+")",1)])]),X(D.value)>G()?(u(),o("div",Es," ğŸ’¡ è™½ç„¶è¿›å¼ å¤šï¼Œä½†è¿›ç‰Œåå¬çš„ç‰Œå°‘ ")):y("",!0)])):y("",!0),V(D.value).length>0?(u(),o("div",Ss,[s[8]||(s[8]=d("div",{class:"missed-title"},"âš ï¸ é”™å¤±çš„æ”¹è¿›æœºä¼š:",-1)),(u(!0),o(m,null,f(V(D.value),e=>(u(),o("div",{key:e.draw,class:"missed-row"},v(e.reason),1))),128))])):y("",!0)],64)):y("",!0),U(D.value)<=2&&0===B(D.value)?(u(),o(m,{key:2},[0===P.value?(u(),o("div",Ds," âœ… å½“å‰è¿›å¼ æ•°æœ€å¤š ")):(u(),o("div",qs,' ğŸ’¡ ç‚¹å‡»"è®¡ç®—æœŸæœ›"å¯åˆ†æè¿›ç‰Œåçš„æƒ…å†µ '))],64)):y("",!0),0===P.value?(u(),o("div",js,"âœ¨ æœ€ä¼˜é€‰æ‹©")):y("",!0)])],4)):y("",!0)]))]);var a}}},[["__scopeId","data-v-cc0a9d35"]]),Ns={class:"empty-state"},Rs={class:"empty-icon"},$s={class:"empty-title"},Qs={key:0,class:"empty-description"},Hs=D({__name:"EmptyState",props:{icon:{type:String,default:"ğŸ“­"},title:{type:String,default:"æš‚æ— æ•°æ®"},description:{type:String,default:""}},setup:e=>(s,a)=>(u(),o("div",Ns,[d("span",Rs,v(e.icon),1),d("p",$s,v(e.title),1),e.description?(u(),o("p",Qs,v(e.description),1)):y("",!0),S(s.$slots,"action",{},void 0)]))},[["__scopeId","data-v-11e29974"]]),Ls={class:"ting-analysis"},Os={key:1,class:"analysis-controls"},Ks=["disabled"],Fs={key:1},Xs={key:2,class:"analysis-progress"},Us={class:"progress-bar"},Bs={class:"progress-text"},Vs={key:3,class:"analysis-result"},Ws={class:"result-header"},Gs={class:"status-icon"},Ys={key:3,class:"listening-info"},Js={class:"listening-tiles"},Zs=["disabled","onClick","title"],ea=["src","alt"],sa={class:"tile-name"},aa={class:"tile-remain"},la={key:0,class:"ting-summary"},ta={class:"ting-stat"},na={class:"stat-value"},ia={class:"ting-stat"},ra={class:"stat-value"},ca={key:4,class:"reduce-partner-hint"},oa={class:"hint-header"},ua={class:"hint-title"},da={class:"hint-body"},va=["src"],pa=["src"],ya={key:6,class:"win-info"},ma=D({__name:"TingAnalysis",setup(e){const s=W("TingAnalysis"),{currentHand:a,isAnalyzing:l,analysisResult:t,analysisProgress:h,analyzeHand:b,addTile:z,updateHand:P,generateRandomHand:T}=q(),{showPatternsList:E,showQuickInput:S}=H(),{quizMode:D,quizStartTime:G,quizResult:Y,setQuizUserAnswer:J,checkQuizAnswer:Z,wrongAnswersPracticeMode:ee,discardQuizMode:se,discardQuizStartTime:ae,discardQuizResult:le,resetDiscardQuiz:te}=L(),{nextPattern:ne,prevPattern:re,randomFromPatterns:ce,selectedPatternsCount:oe}=O(),ue=i(()=>a.value&&0!==a.value.length?K(a.value):null),de=i(()=>{var e;if(!(null==(e=ue.value)?void 0:e.worstPartnerCards)||ue.value.worstPartnerCards.length<2)return null;const[s,a]=ue.value.worstPartnerCards,l=e=>{const s=e%10;return s>=4&&s<=6?10:3===s||7===s?8:2===s||8===s?5:3},t=l(s),n=l(a);return{discardCard:t<=n?s:a,keepCard:t<=n?a:s,isEfficient:ue.value.isEfficientBreak}}),ve=j(),ye=i(()=>ve.favoritesPracticeMode),me=i(()=>oe.value>0||ee.value||ye.value),fe=n(""),ge=n(0),he=n(0);let be=null,ke=null;const we=()=>{const e=fe.value.trim();if(e){const s=[],a=[{regex:/(\d+)m/gi,offset:0},{regex:/(\d+)p/gi,offset:10},{regex:/(\d+)s/gi,offset:20},{regex:/(\d+)z/gi,offset:30}];for(const{regex:l,offset:t}of a){let a;for(;null!==(a=l.exec(e));)for(const e of a[1]){const a=parseInt(e);a>=1&&a<=9&&s.push(a+t)}}s.length>0&&s.length<=14&&(P(s.sort((e,s)=>e-s)),fe.value="")}je()},xe=()=>{be&&clearInterval(be),ge.value=0,be=setInterval(()=>{G.value&&(ge.value=((Date.now()-G.value)/1e3).toFixed(1))},100)},_e=()=>{be&&(clearInterval(be),be=null)},ze=()=>{ke&&clearInterval(ke),he.value=0,ke=setInterval(()=>{ae.value&&(he.value=((Date.now()-ae.value)/1e3).toFixed(1))},100)},Ie=()=>{ke&&(clearInterval(ke),ke=null)};k(D,e=>{e?xe():_e()}),k(G,(e,s)=>{D.value&&e&&e!==s&&xe()}),k(se,e=>{e?ze():Ie()}),k(ae,(e,s)=>{se.value&&e&&e!==s&&ze()});const Pe=()=>{te(),ze()},Te=()=>{te(),T(),ze()},Ae=e=>{J(e),Z(),_e()},Ee=()=>{ne()},Se=e=>{if("INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName){if("Space"===e.code)return e.preventDefault(),se.value&&le.value?void Te():D.value&&Y.value?void Ee():void(oe.value>0&&ce());if("Enter"===e.code&&D.value&&!Y.value)return e.preventDefault(),void Ae();if("ArrowLeft"===e.code&&me.value)return e.preventDefault(),void re();if("ArrowRight"===e.code&&me.value)return e.preventDefault(),void ne();if(!(e.key>="1"&&e.key<="9")||e.ctrlKey||e.altKey||e.metaKey);else if(!se.value&&!D.value){const s=parseInt(e.key);z(s)}}};r(()=>{window.addEventListener("keydown",Se)}),c(()=>{window.removeEventListener("keydown",Se),_e(),Ie()});const De=i(()=>{if(!t.value)return!1;if(!(1===t.value.hu_type||"ready"===t.value.status))return!1;const e=a.value.length;return!F.includes(e)&&(t.value.ting_tiles||[]).length>0}),qe=e=>a.value.filter(s=>s===e).length,je=()=>{return e=null,l=null,t=function*(){if(fe.value){const e=(e=>{if("string"!=typeof e)return[];const s=[],a=e.split(/[,\sï¼Œ\-\/.ã€‚]+/).filter(Boolean).map((e,s)=>e.split("").map(Number).filter(e=>!isNaN(e)).map(e=>10*s+e));for(const l of a)s.push(...l);return s})(fe.value);P(e),fe.value=""}if(s.debug("å¼€å§‹åˆ†æ",a.value),a.value&&a.value.length>0)if(a.value.length>14)R("æ‰‹ç‰Œä¸èƒ½è¶…è¿‡14å¼ ");else try{const e=yield b();(null==e?void 0:e.success)?Q("åˆ†æå®Œæˆ"):R((null==e?void 0:e.message)||"åˆ†æå¤±è´¥")}catch(e){s.error("åˆ†æé”™è¯¯:",e),R("åˆ†æè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯")}else R("è¯·å…ˆé€‰æ‹©æ‰‹ç‰Œ")},new Promise((s,a)=>{var n=e=>{try{r(t.next(e))}catch(s){a(s)}},i=e=>{try{r(t.throw(e))}catch(s){a(s)}},r=e=>e.done?s(e.value):Promise.resolve(e.value).then(n,i);r((t=t.apply(e,l)).next())});var e,l,t},Me=e=>V(e),Ne=e=>{switch(e){case 0:return"â³";case 1:return"âœ…";case 2:return"ğŸ†";case 3:return"âš ï¸";default:return"â“"}};return(e,s)=>{var n,i,r,c;return u(),o("div",Ls,[g(E)?y("",!0):(u(),_(ie,{key:0})),g(S)?(u(),o("div",Os,[w(d("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>fe.value=e),class:"hand-input",placeholder:"å¿«æ·è¾“å…¥ç‰Œå‹ (å¦‚: 123m456p789s)",onKeyup:C(we,["enter"])},null,544),[[x,fe.value]]),d("button",{onClick:we,class:"btn btn-analyze",disabled:g(l)},[g(l)?(u(),_(X,{key:0,size:"small"})):(u(),o("span",Fs,"ğŸ”")),I(" "+v(g(l)?"åˆ†æä¸­...":"åˆ†æ"),1)],8,Ks)])):y("",!0),g(l)&&g(h).stage?(u(),o("div",Xs,[d("div",Us,[d("div",{class:"progress-fill",style:A({width:g(h).percent+"%"})},null,4)]),d("span",Bs,v(g(h).text),1)])):y("",!0),g(t)?(u(),o("div",Vs,[g(D)&&!g(Y)?(u(),_(pe,{key:0,"elapsed-time":ge.value,onSubmit:Ae,onPrev:g(re),onNext:g(ne)},null,8,["elapsed-time","onPrev","onNext"])):y("",!0),g(D)?(u(),_(Ce,{key:1,result:g(Y),onNext:Ee},null,8,["result"])):y("",!0),g(se)?(u(),_(Ue,{key:2,result:g(le),"elapsed-time":he.value,onRetry:Pe,onNext:Te},null,8,["result","elapsed-time"])):y("",!0),d("div",Ws,[d("h4",null,"åˆ†æç»“æœ "+v(De.value?g(U)(g(t)):""),1),d("div",{class:p(["result-status",(c=g(t).hu_type,B(c))])},[d("span",Gs,v(Ne(g(t).hu_type)),1),I(" "+v(Me(g(t).hu_type)),1)],2)]),De.value?(u(),o("div",Ys,[d("h5",null,"ğŸ¯ å¬ç‰Œ "+v(g(U)(g(t))),1),d("div",Js,[(u(!0),o(m,null,f(g(t).ting_tiles||[],e=>(u(),o("button",{key:e,class:p(["listening-tile",{disabled:qe(e)>=4}]),disabled:qe(e)>=4,onClick:s=>{return l=e,void(a.value.length>=N.MAX?R("æ‰‹ç‰Œå·²æ»¡"):qe(l)>=4?R("æ­¤ç‰Œå·²è¾¾åˆ°æœ€å¤§æ•°é‡"):z(l));var l},title:`ç‚¹å‡»æ·»åŠ  ${g($)(e)}`},[d("img",{src:g(M)(e),alt:g($)(e)},null,8,ea),d("span",sa,v(g($)(e)),1),d("span",aa,"ä½™"+v(4-qe(e)),1)],10,Zs))),128))]),g(t).metadata||g(t).ting_count?(u(),o("div",la,[d("div",ta,[s[1]||(s[1]=d("span",{class:"stat-label"},"è¿›å¬æ•°",-1)),d("span",na,v((null==(n=g(t).metadata)?void 0:n.round)||1)+"è¿›å¬",1)]),d("div",ia,[s[2]||(s[2]=d("span",{class:"stat-label"},"å¬ç‰Œæ•°",-1)),d("span",ra,v((g(t).ting_tiles||[]).length)+"é—¨"+v(g(t).ting_count||0)+"å¼ ",1)])])):y("",!0)])):y("",!0),(null==(i=ue.value)?void 0:i.shouldReducePartner)&&de.value?(u(),o("div",ca,[d("div",oa,[s[3]||(s[3]=d("span",{class:"hint-icon"},"âš ï¸",-1)),d("span",ua,v(ue.value.totalPartners)+"æ­éœ€æ‹†æ­",1)]),d("div",da,[s[4]||(s[4]=d("span",{class:"action"},"æ‰“",-1)),d("img",{src:g(M)(de.value.discardCard),class:"hint-tile discard"},null,8,va),s[5]||(s[5]=d("span",{class:"action"},"ç•™",-1)),d("img",{src:g(M)(de.value.keepCard),class:"hint-tile keep"},null,8,pa),d("span",{class:p(["efficiency-tag",de.value.isEfficient?"good":"bad"])},v(de.value.isEfficient?"é«˜æ•ˆ":"ä½æ•ˆ"),3)])])):y("",!0),(null==(r=g(t).recommendations)?void 0:r.length)>0?(u(),_(Ms,{key:5,items:g(t).recommendations},null,8,["items"])):y("",!0),2===g(t).hu_type?(u(),o("div",ya,s[6]||(s[6]=[d("div",{class:"win-icon"},"ğŸ‰",-1),d("h5",null,"æ­å–œèƒ¡ç‰Œï¼",-1),d("p",null,"å½“å‰æ‰‹ç‰Œå·²ç»èƒ¡ç‰Œ",-1)]))):y("",!0)])):y("",!0),!g(t)&&g(a).length>0?(u(),_(Hs,{key:4,icon:"ğŸ”",title:"ç‚¹å‡»åˆ†ææŸ¥çœ‹ç»“æœ",description:"é€‰å¥½æ‰‹ç‰Œåç‚¹å‡»åˆ†ææŒ‰é’®"})):y("",!0)])}}},[["__scopeId","data-v-a3cd2843"]]);export{ma as default};
