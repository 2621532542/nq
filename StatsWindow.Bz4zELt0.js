import{_ as a,a as s,e as t}from"./index.y6HLDFeu.js";import{F as e}from"./FloatingWindow.BEls10vb.js";import{r as l,c as n,w as c,a as i,o,s as d,e as u,v,f as r,b as p,l as h,h as g,n as m,t as b,u as y,F as C,g as f,m as k}from"./vendor.G8ViXyKc.js";const w={class:"stats-content"},S={class:"tab-content"},M={class:"stats-section goal-section"},x={class:"goal-progress"},$={class:"goal-bar"},_={class:"goal-text"},z={key:0,class:"goal-badge"},F={class:"stats-section challenge-section"},j=["disabled"],D={class:"challenge-info"},I={key:0,class:"current-score"},T={class:"stats-section"},q={class:"stats-row"},B={class:"stat-item"},G={class:"stat-value"},H={class:"stat-item"},Q={class:"stat-value"},W={class:"stat-item highlight"},L={class:"stat-value"},A={class:"stats-section"},E={class:"stats-row"},J={class:"stat-item"},K={class:"stat-value"},N={class:"stat-item"},O={class:"stat-value"},P={class:"stat-item"},R={class:"stat-value"},U={class:"stats-section"},V={class:"stats-row streak-row"},X={class:"stat-value"},Y={key:0},Z={class:"stat-item"},aa={class:"stat-value"},sa={class:"stats-section"},ta={class:"stats-row"},ea={class:"stat-item wide"},la={class:"stat-value"},na={key:0,class:"stats-section"},ca={class:"trend-chart"},ia=["title"],oa={key:0,class:"trend-value"},da={class:"trend-label"},ua=a({__name:"StatsWindow",props:{visible:{type:Boolean,default:!0}},emits:["close"],setup(a){s();const{quizStats:ua,loadQuizStats:va,resetQuizStats:ra,statsHistory:pa,loadStatsHistory:ha,challengeMode:ga,challengeStartTime:ma,challengeTimeLimit:ba,challengeScore:ya,challengeBestScore:Ca,startChallenge:fa,endChallenge:ka,loadChallengeStats:wa}=t(),Sa=l(600);let Ma=null;const xa=n(()=>`${Math.floor(Sa.value/60)}:${(Sa.value%60).toString().padStart(2,"0")}`);function $a(){Ma&&(clearInterval(Ma),Ma=null)}c(ga,a=>{a?(Sa.value=ba.value,Ma=setInterval(()=>{if(ma.value){const a=Math.floor((Date.now()-ma.value)/1e3);Sa.value=Math.max(0,ba.value-a),Sa.value<=0&&($a(),ka())}},100)):$a()}),i(()=>{$a()});const _a=n(()=>{const a=ua.value.dailyGoal||60;return Math.min(100,Math.round(ua.value.todayCount/a*100))});function za(){fa()}const Fa=n(()=>0===ua.value.todayCount?0:Math.round(ua.value.todayCorrect/ua.value.todayCount*100)),ja=n(()=>0===ua.value.totalCount?0:Math.round(ua.value.correctCount/ua.value.totalCount*100)),Da=n(()=>0===ua.value.totalCount?"0.0":(ua.value.totalTime/ua.value.totalCount).toFixed(1)),Ia=n(()=>(pa.value||[]).slice(-7)),Ta=n(()=>0===Ia.value.length?1:Math.max(...Ia.value.map(a=>a.count),1));return o(()=>{va(),wa(),ha()}),(s,t)=>(u(),d(e,{visible:a.visible,title:"å­¦ä¹ ç»Ÿè®¡",icon:"ğŸ“Š",theme:"green","storage-key":"quizStats","default-width":300,"default-height":480,"default-x":20,"default-y":150,"min-width":260,"min-height":300,onClose:t[1]||(t[1]=a=>s.$emit("close"))},{"header-extra":v(()=>[r("button",{onClick:t[0]||(t[0]=(...a)=>y(ra)&&y(ra)(...a)),class:"reset-btn",title:"é‡ç½®ç»Ÿè®¡"},"ğŸ”„")]),default:v(()=>[r("div",w,[r("div",S,[r("div",M,[t[2]||(t[2]=r("div",{class:"section-title"},"ğŸ¯ ä»Šæ—¥ç›®æ ‡",-1)),r("div",x,[r("div",$,[r("div",{class:m(["goal-fill",{completed:_a.value>=100}]),style:g({width:_a.value+"%"})},null,6)]),r("div",_,[r("span",{class:m({completed:_a.value>=100})},b(y(ua).todayCount)+" / "+b(y(ua).dailyGoal||60),3),_a.value>=100?(u(),p("span",z,"ğŸ‰ è¾¾æˆ!")):h("",!0)])])]),r("div",F,[r("button",{onClick:za,class:"challenge-btn",disabled:y(ga)},[y(ga)?(u(),p(C,{key:0},[f(" â±ï¸ "+b(xa.value),1)],64)):(u(),p(C,{key:1},[f(" â±ï¸ 10åˆ†é’ŸæŒ‘æˆ˜ ")],64))],8,j),r("div",D,[r("span",null,"æœ€é«˜åˆ†: ğŸ† "+b(y(Ca)),1),y(ga)?(u(),p("span",I,"å¾—åˆ†: "+b(y(ya)),1)):h("",!0)])]),r("div",T,[t[6]||(t[6]=r("div",{class:"section-title"},"ğŸ“… ä»Šæ—¥",-1)),r("div",q,[r("div",B,[r("span",G,b(y(ua).todayCorrect),1),t[3]||(t[3]=r("span",{class:"stat-label"},"æ­£ç¡®",-1))]),r("div",H,[r("span",Q,b(y(ua).todayCount),1),t[4]||(t[4]=r("span",{class:"stat-label"},"æ€»æ•°",-1))]),r("div",W,[r("span",L,b(Fa.value)+"%",1),t[5]||(t[5]=r("span",{class:"stat-label"},"æ­£ç¡®ç‡",-1))])])]),r("div",A,[t[10]||(t[10]=r("div",{class:"section-title"},"ğŸ“ˆ ç´¯è®¡",-1)),r("div",E,[r("div",J,[r("span",K,b(y(ua).correctCount),1),t[7]||(t[7]=r("span",{class:"stat-label"},"æ­£ç¡®",-1))]),r("div",N,[r("span",O,b(y(ua).totalCount),1),t[8]||(t[8]=r("span",{class:"stat-label"},"æ€»æ•°",-1))]),r("div",P,[r("span",R,b(ja.value)+"%",1),t[9]||(t[9]=r("span",{class:"stat-label"},"æ­£ç¡®ç‡",-1))])])]),r("div",U,[t[13]||(t[13]=r("div",{class:"section-title"},"ğŸ”¥ è¿ç»­",-1)),r("div",V,[r("div",{class:m(["stat-item streak",{"on-fire":y(ua).streak>=5}])},[r("span",X,[y(ua).streak>=5?(u(),p("span",Y,"ğŸ”¥")):h("",!0),f(" "+b(y(ua).streak),1)]),t[11]||(t[11]=r("span",{class:"stat-label"},"å½“å‰è¿ç»­",-1))],2),r("div",Z,[r("span",aa,"ğŸ† "+b(y(ua).bestStreak),1),t[12]||(t[12]=r("span",{class:"stat-label"},"æœ€ä½³è®°å½•",-1))])])]),r("div",sa,[t[15]||(t[15]=r("div",{class:"section-title"},"â±ï¸ æ•ˆç‡",-1)),r("div",ta,[r("div",ea,[r("span",la,b(Da.value)+"s",1),t[14]||(t[14]=r("span",{class:"stat-label"},"å¹³å‡ç­”é¢˜ç”¨æ—¶",-1))])])]),Ia.value.length>0?(u(),p("div",na,[t[16]||(t[16]=r("div",{class:"section-title"},"ğŸ“ˆ è¿‘7å¤©è¶‹åŠ¿",-1)),r("div",ca,[(u(!0),p(C,null,k(Ia.value,a=>{return u(),p("div",{key:a.date,class:"trend-bar-wrapper",title:`${a.date}: ${a.correct}/${a.count}`},[r("div",{class:"trend-bar",style:g({height:(t=a.count,Math.round(t/Ta.value*100)+"%")})},[a.count>0?(u(),p("span",oa,b(a.count),1)):h("",!0)],4),r("span",da,b((s=a.date,["æ—¥","ä¸€","äºŒ","ä¸‰","å››","äº”","å…­"][new Date(s).getDay()])),1)],8,ia);var s,t}),128))]),t[17]||(t[17]=r("div",{class:"trend-legend"},[r("span",null,"ç­”é¢˜æ•°é‡è¶‹åŠ¿")],-1))])):h("",!0)])])]),_:1},8,["visible"]))}},[["__scopeId","data-v-0de555cd"]]);export{ua as default};
