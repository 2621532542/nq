import{_ as t,a,e as s}from"./index.D0mN0E-X.js";import{F as l}from"./FloatingWindow.Sno5eSNt.js";import{r as e,c,w as n,a as i,o,q as u,e as r,s as d,f as v,b as p,v as h,n as y,h as m,t as b,u as g,F as f,g as C,l as k}from"./vendor.BQAVRTmg.js";const $={class:"stats-content"},S={class:"stats-tabs"},w={key:0,class:"tab-content"},M={class:"stats-section goal-section"},x={class:"goal-progress"},H={class:"goal-bar"},T={class:"goal-text"},z={key:0,class:"goal-badge"},q={class:"stats-section challenge-section"},D=["disabled"],F={class:"challenge-info"},P={key:0,class:"current-score"},_={class:"stats-section"},j={class:"stats-row"},I={class:"stat-item"},A={class:"stat-value"},B={class:"stat-item"},G={class:"stat-value"},Q={class:"stat-item highlight"},W={class:"stat-value"},L={class:"stats-section"},N={class:"stats-row"},O={class:"stat-item"},E={class:"stat-value"},J={class:"stat-item"},K={class:"stat-value"},R={class:"stat-item"},U={class:"stat-value"},V={class:"stats-section"},X={class:"stats-row streak-row"},Y={class:"stat-value"},Z={key:0},tt={class:"stat-item"},at={class:"stat-value"},st={class:"stats-section"},lt={class:"stats-row"},et={class:"stat-item wide"},ct={class:"stat-value"},nt={key:0,class:"stats-section"},it={class:"trend-chart"},ot=["title"],ut={key:0,class:"trend-value"},rt={class:"trend-label"},dt={key:1,class:"tab-content"},vt={class:"stats-section hourly-section"},pt={class:"hourly-grid"},ht=["title"],yt={class:"hour-num"},mt={class:"hour-status"},bt={class:"stats-section"},gt={class:"stats-row"},ft={class:"stat-item"},Ct={class:"stat-value"},kt={class:"stat-item"},$t={class:"stat-value"},St={class:"stat-item highlight"},wt={class:"stat-value"},Mt={class:"stats-section"},xt={class:"stats-row"},Ht={class:"stat-item"},Tt={class:"stat-value"},zt={class:"stat-item"},qt={class:"stat-value"},Dt={class:"stat-item"},Ft={class:"stat-value"},Pt={class:"stats-section"},_t={class:"stats-row"},jt={class:"stat-item"},It={class:"stat-value"},At={class:"stat-item"},Bt={class:"stat-value"},Gt={key:0,class:"stat-item"},Qt={class:"stat-value"},Wt={class:"stats-section"},Lt={class:"hourly-stats-chart"},Nt=["title"],Ot={class:"bar-container"},Et={class:"bar-label"},Jt={key:0,class:"stats-section"},Kt={class:"trend-chart"},Rt=["title"],Ut={key:0,class:"trend-value"},Vt={class:"trend-label"},Xt=t({__name:"StatsWindow",props:{visible:{type:Boolean,default:!0}},emits:["close"],setup(t){const Xt=a(),{quizStats:Yt,loadQuizStats:Zt,resetQuizStats:ta,statsHistory:aa,loadStatsHistory:sa,challengeMode:la,challengeStartTime:ea,challengeTimeLimit:ca,challengeScore:na,challengeBestScore:ia,startChallenge:oa,endChallenge:ua,loadChallengeStats:ra}=s(),da=e("quiz"),va=c(()=>Xt.discardPracticeStats),pa=c(()=>Xt.discardPracticeHistory),ha=c(()=>(new Date).getHours()),ya=c(()=>{const t=[];for(let a=6;a<=23;a++)t.push(a);return t}),ma=c(()=>{const t=va.value.todayHourlyStats||{};return Object.keys(t).map(Number).sort((t,a)=>t-a)}),ba=c(()=>0===va.value.todayCount?0:Math.round(va.value.todayCorrect/va.value.todayCount*100)),ga=c(()=>0===va.value.totalCount?0:Math.round(va.value.correctCount/va.value.totalCount*100)),fa=c(()=>Xt.discardTodayAverageTime.toFixed(1)),Ca=c(()=>Xt.discardAverageTime.toFixed(1)),ka=c(()=>{var t;return(null==(t=Xt.hourlyProgress)?void 0:t.duration)||0});function $a(t){if(t<60)return`${Math.round(t)}s`;return`${Math.floor(t/60)}m${Math.round(t%60)}s`}function Sa(t){const a=(va.value.todayHourlyStats||{})[t];return t===ha.value?"current":a?a.completed?"completed":a.total>0?"in-progress":"pending":t<ha.value?"missed":"pending"}function wa(t){const a=(va.value.todayHourlyStats||{})[t];return a?a.completed?"âœ“":`${a.total}/${a.generated}`:t<ha.value?"â€”":""}function Ma(t){const a=(va.value.todayHourlyStats||{})[t];if(!a)return`${t}ç‚¹ï¼šæœªå¼€å§‹`;const s=a.total>0?Math.round(a.correct/a.total*100):0;return`${t}ç‚¹ï¼š${a.correct}/${a.total} æ­£ç¡®ç‡${s}%`}function xa(t){const a=(va.value.todayHourlyStats||{})[t];return a&&0!==a.total?Math.round(a.correct/a.total*100):0}function Ha(t){const a=(va.value.todayHourlyStats||{})[t];if(!a)return`${t}ç‚¹ï¼šæ— æ•°æ®`;const s=a.total>0?(a.totalTime/a.total).toFixed(1):0,l=a.endTime&&a.startTime?$a((a.endTime-a.startTime)/1e3):"-";return`${t}ç‚¹ï¼šæ­£ç¡®${a.correct}/${a.total}ï¼Œæ­£ç¡®ç‡${xa(t)}%ï¼Œå¹³å‡${s}sï¼Œç”¨æ—¶${l}`}const Ta=c(()=>pa.value.slice(-7)),za=c(()=>0===Ta.value.length?1:Math.max(...Ta.value.map(t=>t.count),1));function qa(){Xt.resetDiscardPracticeStats()}const Da=e(600);let Fa=null;const Pa=c(()=>`${Math.floor(Da.value/60)}:${(Da.value%60).toString().padStart(2,"0")}`);function _a(){Fa&&(clearInterval(Fa),Fa=null)}n(la,t=>{t?(Da.value=ca.value,Fa=setInterval(()=>{if(ea.value){const t=Math.floor((Date.now()-ea.value)/1e3);Da.value=Math.max(0,ca.value-t),Da.value<=0&&(_a(),ua())}},100)):_a()}),i(()=>{_a()});const ja=c(()=>{const t=Yt.value.dailyGoal||60;return Math.min(100,Math.round(Yt.value.todayCount/t*100))});function Ia(){oa()}const Aa=c(()=>0===Yt.value.todayCount?0:Math.round(Yt.value.todayCorrect/Yt.value.todayCount*100)),Ba=c(()=>0===Yt.value.totalCount?0:Math.round(Yt.value.correctCount/Yt.value.totalCount*100)),Ga=c(()=>0===Yt.value.totalCount?"0.0":(Yt.value.totalTime/Yt.value.totalCount).toFixed(1)),Qa=c(()=>(aa.value||[]).slice(-7)),Wa=c(()=>0===Qa.value.length?1:Math.max(...Qa.value.map(t=>t.count),1));function La(t){return["æ—¥","ä¸€","äºŒ","ä¸‰","å››","äº”","å…­"][new Date(t).getDay()]}return o(()=>{Zt(),ra(),sa(),Xt.loadDiscardPracticeStats(),Xt.loadDiscardPracticeHistory()}),(a,s)=>(r(),u(l,{visible:t.visible,title:"å­¦ä¹ ç»Ÿè®¡",icon:"ğŸ“Š",theme:"green","storage-key":"quizStats","default-width":300,"default-height":480,"default-x":20,"default-y":150,"min-width":260,"min-height":300,onClose:s[3]||(s[3]=t=>a.$emit("close"))},{"header-extra":d(()=>[v("button",{onClick:s[0]||(s[0]=(...t)=>g(ta)&&g(ta)(...t)),class:"reset-btn",title:"é‡ç½®ç»Ÿè®¡"},"ğŸ”„")]),default:d(()=>[v("div",$,[v("div",S,[v("button",{class:y(["tab-btn",{active:"quiz"===da.value}]),onClick:s[1]||(s[1]=t=>da.value="quiz")}," ğŸ“ å¬ç‰Œç»ƒä¹  ",2),v("button",{class:y(["tab-btn",{active:"discard"===da.value}]),onClick:s[2]||(s[2]=t=>da.value="discard")}," ğŸ¯ èˆç‰Œç»ƒä¹  ",2)]),"quiz"===da.value?(r(),p("div",w,[v("div",M,[s[4]||(s[4]=v("div",{class:"section-title"},"ğŸ¯ ä»Šæ—¥ç›®æ ‡",-1)),v("div",x,[v("div",H,[v("div",{class:y(["goal-fill",{completed:ja.value>=100}]),style:m({width:ja.value+"%"})},null,6)]),v("div",T,[v("span",{class:y({completed:ja.value>=100})},b(g(Yt).todayCount)+" / "+b(g(Yt).dailyGoal||60),3),ja.value>=100?(r(),p("span",z,"ğŸ‰ è¾¾æˆ!")):h("",!0)])])]),v("div",q,[v("button",{onClick:Ia,class:"challenge-btn",disabled:g(la)},[g(la)?(r(),p(f,{key:0},[C(" â±ï¸ "+b(Pa.value),1)],64)):(r(),p(f,{key:1},[C(" â±ï¸ 10åˆ†é’ŸæŒ‘æˆ˜ ")],64))],8,D),v("div",F,[v("span",null,"æœ€é«˜åˆ†: ğŸ† "+b(g(ia)),1),g(la)?(r(),p("span",P,"å¾—åˆ†: "+b(g(na)),1)):h("",!0)])]),v("div",_,[s[8]||(s[8]=v("div",{class:"section-title"},"ğŸ“… ä»Šæ—¥",-1)),v("div",j,[v("div",I,[v("span",A,b(g(Yt).todayCorrect),1),s[5]||(s[5]=v("span",{class:"stat-label"},"æ­£ç¡®",-1))]),v("div",B,[v("span",G,b(g(Yt).todayCount),1),s[6]||(s[6]=v("span",{class:"stat-label"},"æ€»æ•°",-1))]),v("div",Q,[v("span",W,b(Aa.value)+"%",1),s[7]||(s[7]=v("span",{class:"stat-label"},"æ­£ç¡®ç‡",-1))])])]),v("div",L,[s[12]||(s[12]=v("div",{class:"section-title"},"ğŸ“ˆ ç´¯è®¡",-1)),v("div",N,[v("div",O,[v("span",E,b(g(Yt).correctCount),1),s[9]||(s[9]=v("span",{class:"stat-label"},"æ­£ç¡®",-1))]),v("div",J,[v("span",K,b(g(Yt).totalCount),1),s[10]||(s[10]=v("span",{class:"stat-label"},"æ€»æ•°",-1))]),v("div",R,[v("span",U,b(Ba.value)+"%",1),s[11]||(s[11]=v("span",{class:"stat-label"},"æ­£ç¡®ç‡",-1))])])]),v("div",V,[s[15]||(s[15]=v("div",{class:"section-title"},"ğŸ”¥ è¿ç»­",-1)),v("div",X,[v("div",{class:y(["stat-item streak",{"on-fire":g(Yt).streak>=5}])},[v("span",Y,[g(Yt).streak>=5?(r(),p("span",Z,"ğŸ”¥")):h("",!0),C(" "+b(g(Yt).streak),1)]),s[13]||(s[13]=v("span",{class:"stat-label"},"å½“å‰è¿ç»­",-1))],2),v("div",tt,[v("span",at,"ğŸ† "+b(g(Yt).bestStreak),1),s[14]||(s[14]=v("span",{class:"stat-label"},"æœ€ä½³è®°å½•",-1))])])]),v("div",st,[s[17]||(s[17]=v("div",{class:"section-title"},"â±ï¸ æ•ˆç‡",-1)),v("div",lt,[v("div",et,[v("span",ct,b(Ga.value)+"s",1),s[16]||(s[16]=v("span",{class:"stat-label"},"å¹³å‡ç­”é¢˜ç”¨æ—¶",-1))])])]),Qa.value.length>0?(r(),p("div",nt,[s[18]||(s[18]=v("div",{class:"section-title"},"ğŸ“ˆ è¿‘7å¤©è¶‹åŠ¿",-1)),v("div",it,[(r(!0),p(f,null,k(Qa.value,t=>{return r(),p("div",{key:t.date,class:"trend-bar-wrapper",title:`${t.date}: ${t.correct}/${t.count}`},[v("div",{class:"trend-bar",style:m({height:(a=t.count,Math.round(a/Wa.value*100)+"%")})},[t.count>0?(r(),p("span",ut,b(t.count),1)):h("",!0)],4),v("span",rt,b(La(t.date)),1)],8,ot);var a}),128))]),s[19]||(s[19]=v("div",{class:"trend-legend"},[v("span",null,"ç­”é¢˜æ•°é‡è¶‹åŠ¿")],-1))])):h("",!0)])):h("",!0),"discard"===da.value?(r(),p("div",dt,[v("div",vt,[s[20]||(s[20]=v("div",{class:"section-title"},"â° ä»Šæ—¥æ•´ç‚¹è¿›åº¦",-1)),v("div",pt,[(r(!0),p(f,null,k(ya.value,t=>(r(),p("div",{key:t,class:y(["hourly-item",Sa(t)]),title:Ma(t)},[v("span",yt,b(t),1),v("span",mt,b(wa(t)),1)],10,ht))),128))]),s[21]||(s[21]=v("div",{class:"hourly-legend"},[v("span",{class:"legend-item"},[v("span",{class:"dot completed"}),C(" å·²å®Œæˆ")]),v("span",{class:"legend-item"},[v("span",{class:"dot current"}),C(" è¿›è¡Œä¸­")]),v("span",{class:"legend-item"},[v("span",{class:"dot pending"}),C(" å¾…å®Œæˆ")])],-1))]),v("div",bt,[s[25]||(s[25]=v("div",{class:"section-title"},"ğŸ“… ä»Šæ—¥èˆç‰Œç»ƒä¹ ",-1)),v("div",gt,[v("div",ft,[v("span",Ct,b(va.value.todayCorrect),1),s[22]||(s[22]=v("span",{class:"stat-label"},"æ­£ç¡®",-1))]),v("div",kt,[v("span",$t,b(va.value.todayCount),1),s[23]||(s[23]=v("span",{class:"stat-label"},"æ€»æ•°",-1))]),v("div",St,[v("span",wt,b(ba.value)+"%",1),s[24]||(s[24]=v("span",{class:"stat-label"},"æ­£ç¡®ç‡",-1))])])]),v("div",Mt,[s[29]||(s[29]=v("div",{class:"section-title"},"ğŸ“ˆ ç´¯è®¡èˆç‰Œç»ƒä¹ ",-1)),v("div",xt,[v("div",Ht,[v("span",Tt,b(va.value.correctCount),1),s[26]||(s[26]=v("span",{class:"stat-label"},"æ­£ç¡®",-1))]),v("div",zt,[v("span",qt,b(va.value.totalCount),1),s[27]||(s[27]=v("span",{class:"stat-label"},"æ€»æ•°",-1))]),v("div",Dt,[v("span",Ft,b(ga.value)+"%",1),s[28]||(s[28]=v("span",{class:"stat-label"},"æ­£ç¡®ç‡",-1))])])]),v("div",Pt,[s[33]||(s[33]=v("div",{class:"section-title"},"â±ï¸ æ•ˆç‡ç»Ÿè®¡",-1)),v("div",_t,[v("div",jt,[v("span",It,b(fa.value)+"s",1),s[30]||(s[30]=v("span",{class:"stat-label"},"ä»Šæ—¥å¹³å‡",-1))]),v("div",At,[v("span",Bt,b(Ca.value)+"s",1),s[31]||(s[31]=v("span",{class:"stat-label"},"ç´¯è®¡å¹³å‡",-1))]),ka.value>0?(r(),p("div",Gt,[v("span",Qt,b($a(ka.value)),1),s[32]||(s[32]=v("span",{class:"stat-label"},"æœ¬è½®ç”¨æ—¶",-1))])):h("",!0)])]),v("div",Wt,[s[34]||(s[34]=v("div",{class:"section-title"},"ğŸ“Š æ•´ç‚¹å®Œæˆæƒ…å†µ",-1)),v("div",Lt,[(r(!0),p(f,null,k(ma.value,t=>(r(),p("div",{key:t,class:"hourly-stat-bar",title:Ha(t)},[v("div",Ot,[v("div",{class:"bar-fill correct",style:m({height:xa(t)+"%"})},null,4)]),v("span",Et,b(t),1)],8,Nt))),128))]),s[35]||(s[35]=v("div",{class:"chart-legend"},[v("span",null,"å„æ•´ç‚¹æ­£ç¡®ç‡ (%)")],-1))]),pa.value.length>0?(r(),p("div",Jt,[s[36]||(s[36]=v("div",{class:"section-title"},"ğŸ“ˆ è¿‘7å¤©èˆç‰Œè¶‹åŠ¿",-1)),v("div",Kt,[(r(!0),p(f,null,k(Ta.value,t=>{return r(),p("div",{key:t.date,class:"trend-bar-wrapper",title:`${t.date}: ${t.correct}/${t.count}`},[v("div",{class:"trend-bar discard",style:m({height:(a=t.count,Math.round(a/za.value*100)+"%")})},[t.count>0?(r(),p("span",Ut,b(t.count),1)):h("",!0)],4),v("span",Vt,b(La(t.date)),1)],8,Rt);var a}),128))]),s[37]||(s[37]=v("div",{class:"trend-legend"},[v("span",null,"èˆç‰Œç»ƒä¹ æ•°é‡è¶‹åŠ¿")],-1))])):h("",!0),v("div",{class:"stats-section"},[v("button",{onClick:qa,class:"reset-discard-btn"}," ğŸ”„ é‡ç½®èˆç‰Œç»Ÿè®¡ ")])])):h("",!0)])]),_:1},8,["visible"]))}},[["__scopeId","data-v-31a0ea2a"]]);export{Xt as default};
